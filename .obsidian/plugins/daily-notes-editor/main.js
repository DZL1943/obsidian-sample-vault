"use strict";var de=Object.defineProperty;var fe=(e,t,n)=>t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var dt=(e,t,n)=>fe(e,typeof t!="symbol"?t+"":t,n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const g=require("obsidian");function A(){}function It(e){return e()}function _t(){return Object.create(null)}function D(e){e.forEach(It)}function vt(e){return typeof e=="function"}function Yt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ue(e){return Object.keys(e).length===0}function Rt(e){return e&&vt(e.destroy)?e.destroy:A}function x(e,t){e.appendChild(t)}function H(e,t,n){e.insertBefore(t,n||null)}function T(e){e.parentNode&&e.parentNode.removeChild(e)}function P(e){return document.createElement(e)}function kt(e){return document.createTextNode(e)}function N(){return kt(" ")}function he(){return kt("")}function R(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function $(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function pe(e){return Array.from(e.childNodes)}function ge(e,t){t=""+t,e.data!==t&&(e.data=t)}let bt;function U(e){bt=e}const I=[],ht=[];let j=[];const $t=[],me=Promise.resolve();let pt=!1;function we(){pt||(pt=!0,me.then(jt))}function gt(e){j.push(e)}const ft=new Set;let B=0;function jt(){if(B!==0)return;const e=bt;do{try{for(;B<I.length;){const t=I[B];B++,U(t),ye(t.$$)}}catch(t){throw I.length=0,B=0,t}for(U(null),I.length=0,B=0;ht.length;)ht.pop()();for(let t=0;t<j.length;t+=1){const n=j[t];ft.has(n)||(ft.add(n),n())}j.length=0}while(I.length);for(;$t.length;)$t.pop()();pt=!1,ft.clear(),U(e)}function ye(e){if(e.fragment!==null){e.update(),D(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(gt)}}function ve(e){const t=[],n=[];j.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),j=t}const at=new Set;let O;function ke(){O={r:0,c:[],p:O}}function be(){O.r||D(O.c),O=O.p}function ct(e,t){e&&e.i&&(at.delete(e),e.i(t))}function Et(e,t,n,i){if(e&&e.o){if(at.has(e))return;at.add(e),O.c.push(()=>{at.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}function Ct(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ee(e,t){Et(e,1,1,()=>{t.delete(e.key)})}function Se(e,t,n,i,o,s,r,a,l,c,f,d){let u=e.length,m=s.length,v=u;const w={};for(;v--;)w[e[v].key]=v;const p=[],h=new Map,b=new Map,S=[];for(v=m;v--;){const k=d(o,s,v),_=n(k);let C=r.get(_);C?S.push(()=>C.p(k,t)):(C=c(_,k),C.c()),h.set(_,p[v]=C),_ in w&&b.set(_,Math.abs(v-w[_]))}const et=new Set,nt=new Set;function E(k){ct(k,1),k.m(a,f),r.set(k.key,k),f=k.first,m--}for(;u&&m;){const k=p[m-1],_=e[u-1],C=k.key,W=_.key;k===_?(f=k.first,u--,m--):h.has(W)?!r.has(C)||et.has(C)?E(k):nt.has(W)?u--:b.get(C)>b.get(W)?(nt.add(C),E(k)):(et.add(W),u--):(l(_,r),u--)}for(;u--;){const k=e[u];h.has(k.key)||l(k,r)}for(;m;)E(p[m-1]);return D(S),p}function Le(e){e&&e.c()}function qt(e,t,n){const{fragment:i,after_update:o}=e.$$;i&&i.m(t,n),gt(()=>{const s=e.$$.on_mount.map(It).filter(vt);e.$$.on_destroy?e.$$.on_destroy.push(...s):D(s),e.$$.on_mount=[]}),o.forEach(gt)}function Vt(e,t){const n=e.$$;n.fragment!==null&&(ve(n.after_update),D(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function _e(e,t){e.$$.dirty[0]===-1&&(I.push(e),we(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ut(e,t,n,i,o,s,r=null,a=[-1]){const l=bt;U(e);const c=e.$$={fragment:null,ctx:[],props:s,update:A,not_equal:o,bound:_t(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:_t(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let f=!1;if(c.ctx=n?n(e,t.props||{},(d,u,...m)=>{const v=m.length?m[0]:u;return c.ctx&&o(c.ctx[d],c.ctx[d]=v)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](v),f&&_e(e,d)),u}):[],c.update(),f=!0,D(c.before_update),c.fragment=i?i(c.ctx):!1,t.target){if(t.hydrate){const d=pe(t.target);c.fragment&&c.fragment.l(d),d.forEach(T)}else c.fragment&&c.fragment.c();t.intro&&ct(e.$$.fragment),qt(e,t.target,t.anchor),jt()}U(l)}class zt{constructor(){dt(this,"$$");dt(this,"$$set")}$destroy(){Vt(this,1),this.$destroy=A}$on(t,n){if(!vt(n))return A;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!ue(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const $e="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add($e);function Ce(e,t,n,i){function o(s){return s instanceof n?s:new n(function(r){r(s)})}return new(n||(n=Promise))(function(s,r){function a(f){try{c(i.next(f))}catch(d){r(d)}}function l(f){try{c(i.throw(f))}catch(d){r(d)}}function c(f){f.done?s(f.value):o(f.value).then(a,l)}c((i=i.apply(e,[])).next())})}function Qt(e){const t=[];for(let n=0;n<e;n++)t.push((16*Math.random()|0).toString(16));return t.join("")}const it=new WeakMap;function xt(e){return e.containerEl.matches(".dn-editor.dn-leaf-view .workspace-leaf")}function xe(e){const t=function(){return Object.setPrototypeOf(new g.Component,new.target.prototype)};return t.prototype=e.prototype,Object.setPrototypeOf(t,e)}const Pe=(e,t,n,i)=>{let o=e.app.workspace.activeLeaf;o||(o=n),t||(t=o==null?void 0:o.containerEl);const s=new z(o,t,e,void 0,i);return[s.attachLeaf(),s]};class z extends xe(g.HoverPopover){constructor(t,n,i,o,s){var a,l;super(),this.targetEl=n,this.plugin=i,this.onShowCallback=s,this.abortController=this.addChild(new g.Component),this.detaching=!1,this.opening=!1,this.rootSplit=new g.WorkspaceSplit(window.app.workspace,"vertical"),this.isPinned=!0,this.oldPopover=(a=this.parent)==null?void 0:a.DailyNoteEditor,this.id=Qt(8),o===void 0&&(o=300),this.onTarget=!0,this.parent=t,this.waitTime=o,this.state=g.PopoverState.Showing,this.document=((l=this.targetEl)==null?void 0:l.ownerDocument)??window.activeDocument??window.document,this.hoverEl=this.document.defaultView.createDiv({cls:"dn-editor dn-leaf-view",attr:{id:"dn-"+this.id}});const{hoverEl:r}=this;this.abortController.load(),this.timer=window.setTimeout(this.show.bind(this),o),this.setActive=this._setActive.bind(this),r&&r.addEventListener("mousedown",this.setActive),it.set(this.hoverEl,this),this.hoverEl.addClass("dn-editor"),this.containerEl=this.hoverEl.createDiv("dn-content"),this.buildWindowControls(),this.setInitialDimensions()}static activeWindows(){const t=[window],{floatingSplit:n}=app.workspace;if(n)for(const i of n.children)i.win&&t.push(i.win);return t}static containerForDocument(t,n){if(n!==document&&t.app.workspace.floatingSplit){for(const i of t.app.workspace.floatingSplit.children)if(i.doc===n)return i}return t.app.workspace.rootSplit}static activePopovers(){return this.activeWindows().flatMap(this.popoversForWindow)}static popoversForWindow(t){var n;return Array.prototype.slice.call(((n=t==null?void 0:t.document)==null?void 0:n.body.querySelectorAll(".dn-leaf-view"))??[]).map(i=>it.get(i)).filter(i=>i)}static forLeaf(t){const n=t&&document.body.matchParent.call(t.containerEl,".dn-leaf-view");return n?it.get(n):void 0}static iteratePopoverLeaves(t,n){for(const i of this.activePopovers())if(i.rootSplit&&t.iterateLeaves(n,i.rootSplit))return!0;return!1}_setActive(t){t.preventDefault(),t.stopPropagation(),this.plugin.app.workspace.setActiveLeaf(this.leaves()[0],{focus:!0})}getDefaultMode(){return"source"}updateLeaves(){this.onTarget&&this.targetEl&&!this.document.contains(this.targetEl)&&(this.onTarget=!1,this.transition());let t=0;this.plugin.app.workspace.iterateLeaves(n=>{t++},this.rootSplit),t===0&&this.hide(),this.hoverEl.setAttribute("data-leaf-count",t.toString())}leaves(){const t=[];return this.plugin.app.workspace.iterateLeaves(n=>{t.push(n)},this.rootSplit),t}setInitialDimensions(){this.hoverEl.style.height="auto",this.hoverEl.style.width="100%"}transition(){this.shouldShow()?this.state===g.PopoverState.Hiding&&(this.state=g.PopoverState.Shown,clearTimeout(this.timer)):this.state===g.PopoverState.Showing?this.hide():this.state===g.PopoverState.Shown&&(this.state=g.PopoverState.Hiding,this.timer=window.setTimeout(()=>{this.shouldShow()?this.transition():this.hide()},this.waitTime))}buildWindowControls(){this.titleEl=this.document.defaultView.createDiv("popover-titlebar"),this.titleEl.createDiv("popover-title"),this.containerEl.prepend(this.titleEl)}attachLeaf(){this.rootSplit.getRoot=()=>this.plugin.app.workspace[this.document===document?"rootSplit":"floatingSplit"],this.rootSplit.getContainer=()=>z.containerForDocument(this.plugin,this.document),this.titleEl.insertAdjacentElement("afterend",this.rootSplit.containerEl);const t=this.plugin.app.workspace.createLeafInParent(this.rootSplit,0);return this.updateLeaves(),t}onload(){super.onload(),this.registerEvent(this.plugin.app.workspace.on("layout-change",this.updateLeaves,this)),this.registerEvent(app.workspace.on("layout-change",()=>{this.rootSplit.children.forEach((t,n)=>{t instanceof g.WorkspaceTabs&&this.rootSplit.replaceChild(n,t.children[0])})}))}onShow(){var s,r;setTimeout(()=>this.waitTime=600,600),(s=this.oldPopover)==null||s.hide(),this.oldPopover=null,this.hoverEl.toggleClass("is-new",!0),this.document.body.addEventListener("click",()=>{this.hoverEl.toggleClass("is-new",!1)},{once:!0,capture:!0}),this.parent&&(this.parent.DailyNoteEditor=this);const n=this.hoverEl.querySelector(".view-header");n==null||n.remove();const i=this.hoverEl.querySelector(".workspace-leaf");i&&this.hoverEl.appendChild(i);const o=this.hoverEl.querySelector(".inline-title");o&&o.remove(),(r=this.onShowCallback)==null||r.call(this),this.onShowCallback=void 0}detect(t){const{targetEl:n}=this;n&&(this.onTarget=t===n||n.contains(t))}shouldShow(){return this.shouldShowSelf()||this.shouldShowChild()}shouldShowChild(){return z.activePopovers().some(t=>t!==this&&t.targetEl&&this.hoverEl.contains(t.targetEl)?t.shouldShow():!1)}shouldShowSelf(){return!this.detaching&&!!(this.onTarget||this.state==g.PopoverState.Shown||this.document.querySelector(`body>.modal-container, body > #he${this.id} ~ .menu, body > #he${this.id} ~ .suggestion-container`))}show(){!this.targetEl||this.document.body.contains(this.targetEl)?(this.state=g.PopoverState.Shown,this.timer=0,this.targetEl.appendChild(this.hoverEl),this.onShow(),app.workspace.onLayoutChange(),this.load()):this.hide(),this.hoverEl.dataset.imgHeight&&this.hoverEl.dataset.imgWidth&&(this.hoverEl.style.height=parseFloat(this.hoverEl.dataset.imgHeight)+this.titleEl.offsetHeight+"px",this.hoverEl.style.width=parseFloat(this.hoverEl.dataset.imgWidth)+"px")}onHide(){var t;this.oldPopover=null,((t=this.parent)==null?void 0:t.DailyNoteEditor)===this&&(this.parent.DailyNoteEditor=null)}hide(){var n;if(this.onTarget=!1,this.detaching=!0,this.timer&&(clearTimeout(this.timer),this.timer=0),this.hoverEl.hide(),this.opening)return;const t=this.leaves();if(t.length)t[0].detach();else return this.parent=null,(n=this.abortController)==null||n.unload(),this.abortController=void 0,this.nativeHide()}nativeHide(){var i;const{hoverEl:t,targetEl:n}=this;if(this.state=g.PopoverState.Hidden,t.detach(),n){const o=n.matchParent(".dn-leaf-view");o&&((i=it.get(o))==null||i.transition())}this.onHide(),this.unload()}resolveLink(t,n){const i=g.parseLinktext(t);return i?this.plugin.app.metadataCache.getFirstLinkpathDest(i.path,n):null}async openLink(t,n,i,o){var m,v,w;let s=this.resolveLink(t,n);const r=g.parseLinktext(t);if(!s&&o){const p=this.plugin.app.fileManager.getNewFileParent(n);s=await this.plugin.app.fileManager.createNewMarkdownFile(p,r.path)}if(!s)return;const{viewRegistry:a}=this.plugin.app,l=a.typeByExtension[s.extension];if(!l||!a.viewByType[l])return;i=Object.assign(this.buildEphemeralState(s,r),i);const c=this.getDefaultMode(),f=this.buildState(c,i),d=await this.openFile(s,f,o),u=(m=d==null?void 0:d.view)==null?void 0:m.getViewType();if(u==="image"){(v=this.parent)!=null&&v.hasOwnProperty("editorEl")&&this.parent.editorEl.hasClass("is-live-preview")&&(this.waitTime=3e3);const p=d.view.contentEl.querySelector("img");this.hoverEl.dataset.imgHeight=String(p.naturalHeight),this.hoverEl.dataset.imgWidth=String(p.naturalWidth),this.hoverEl.dataset.imgRatio=String(p.naturalWidth/p.naturalHeight)}else u==="pdf"&&(this.hoverEl.style.height="800px",this.hoverEl.style.width="600px");((w=f.state)==null?void 0:w.mode)==="source"&&this.whenShown(()=>{var p,h,b,S;g.requireApiVersion("1.0")&&((b=(h=(p=d==null?void 0:d.view)==null?void 0:p.editMode)==null?void 0:h.reinit)==null||b.call(h)),(S=d==null?void 0:d.view)==null||S.setEphemeralState(f.eState)})}whenShown(t){if(this.detaching)return;const n=this.onShowCallback;this.onShowCallback=()=>{this.detaching||(t(),typeof n=="function"&&n())},this.state===g.PopoverState.Shown&&(this.onShowCallback(),this.onShowCallback=void 0)}async openFile(t,n,i){if(this.detaching)return;const o=i??this.attachLeaf();this.opening=!0;try{await o.openFile(t,n)}catch(s){console.error(s)}finally{this.opening=!1,this.detaching&&this.hide()}return this.plugin.app.workspace.setActiveLeaf(o),o}buildState(t,n){return{active:!1,state:{mode:"source"},eState:n}}buildEphemeralState(t,n){const i=this.plugin.app.metadataCache.getFileCache(t),o=i?g.resolveSubpath(i,(n==null?void 0:n.subpath)||""):void 0,s={subpath:n==null?void 0:n.subpath};return o&&(s.line=o.start.line,s.startLoc=o.start,s.endLoc=o.end||void 0),s}}function Fe(e){return e()}function Me(e){e.forEach(Fe)}const ot=[],Pt=[],lt=[],Ft=[],Zt=Promise.resolve();let mt=!1;function De(){mt||(mt=!0,Zt.then(Oe))}function Te(){return De(),Zt}function Ne(e){lt.push(e)}const ut=new Set;let st=0;function Oe(){do{for(;st<ot.length;){const e=ot[st];st++,Ae(e.$$)}for(ot.length=0,st=0;Pt.length;)Pt.pop()();for(let e=0;e<lt.length;e+=1){const t=lt[e];ut.has(t)||(ut.add(t),t())}lt.length=0}while(ot.length);for(;Ft.length;)Ft.pop()();mt=!1,ut.clear()}function Ae(e){if(e.fragment!==null){e.update(),Me(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ne)}}const He={root:null,rootMargin:"0px",threshold:0,unobserveOnEnter:!1},M=(e,t)=>new CustomEvent(e,{detail:t});function Gt(e,t={}){const{root:n,rootMargin:i,threshold:o,unobserveOnEnter:s}=Object.assign(Object.assign({},He),t);let r={x:void 0,y:void 0},a={vertical:void 0,horizontal:void 0};if(typeof IntersectionObserver<"u"&&e){const l=new IntersectionObserver((c,f)=>{c.forEach(d=>{r.y>d.boundingClientRect.y?a.vertical="up":a.vertical="down",r.x>d.boundingClientRect.x?a.horizontal="left":a.horizontal="right",r={y:d.boundingClientRect.y,x:d.boundingClientRect.x};const u={inView:d.isIntersecting,entry:d,scrollDirection:a,node:e,observer:f};e.dispatchEvent(M("inview_change",u)),e.dispatchEvent(M("change",u)),d.isIntersecting?(e.dispatchEvent(M("inview_enter",u)),e.dispatchEvent(M("enter",u)),s&&f.unobserve(e)):(e.dispatchEvent(M("inview_leave",u)),e.dispatchEvent(M("leave",u)))})},{root:n,rootMargin:i,threshold:o});return Te().then(()=>{e.dispatchEvent(M("inview_init",{observer:l,node:e})),e.dispatchEvent(M("init",{observer:l,node:e}))}),l.observe(e),{destroy(){l.unobserve(e)}}}}function Mt(e){let t,n,i,o,s,r;return{c(){t=P("div"),n=kt(e[1]),i=N(),o=P("div"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-symlink"><path d="m10 18 3-3-3-3"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path><path d="M4 11V4a2 2 0 0 1 2-2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h7"></path></svg>',$(o,"class","daily-node-icon clickable-icon svelte-18gimyz"),$(o,"aria-hidden","true"),$(t,"class","daily-note-title inline-title svelte-18gimyz")},m(a,l){H(a,t,l),x(t,n),x(t,i),x(t,o),s||(r=R(o,"click",e[3]),s=!0)},p(a,l){l&2&&ge(n,a[1])},d(a){a&&T(t),s=!1,r()}}}function We(e){let t,n,i,o,s,r,a,l,c,f=e[1]&&Mt(e);return{c(){t=P("div"),n=P("div"),f&&f.c(),i=N(),o=P("div"),s=N(),r=P("div"),$(o,"class","daily-note-editor"),$(o,"aria-label",e[1]),$(n,"class","daily-note svelte-18gimyz"),$(t,"class","daily-note-container"),$(t,"aria-label",a="dn-editor-"+e[2])},m(d,u){H(d,t,u),x(t,n),f&&f.m(n,null),x(n,i),x(n,o),e[8](o),x(t,s),x(t,r),l||(c=[Rt(Gt.call(null,r,{rootMargin:"20%"})),R(r,"inview_enter",e[4])],l=!0)},p(d,[u]){d[1]?f?f.p(d,u):(f=Mt(d),f.c(),f.m(n,i)):f&&(f.d(1),f=null),u&2&&$(o,"aria-label",d[1]),u&4&&a!==(a="dn-editor-"+d[2])&&$(t,"aria-label",a)},i:A,o:A,d(d){d&&T(t),f&&f.d(),e[8](null),l=!1,D(c)}}}function Be(e,t,n){let{file:i}=t,{plugin:o}=t,{leaf:s}=t,r,a,l=!1,c,f;function d(){i instanceof g.TFile&&(l||(n(1,a=i.basename),[f]=Pe(o,r,s),f.setPinned(!0),f.openFile(i,{active:!1,state:{mode:"source",backlinks:!o.settings.hideBacklinks}}),f.parentLeaf=s,l=!0))}function u(){i instanceof g.TFile&&(s?s.openFile(i):o.app.workspace.getLeaf(!1).openFile(i))}function m(w){const{scrollDirection:p}=w.detail;p.vertical==="down"&&d()}function v(w){ht[w?"unshift":"push"](()=>{r=w,n(0,r)})}return e.$$set=w=>{"file"in w&&n(5,i=w.file),"plugin"in w&&n(6,o=w.plugin),"leaf"in w&&n(7,s=w.leaf)},e.$$.update=()=>{e.$$.dirty&1&&r&&(d(),n(2,c=Qt(8)))},[r,a,c,u,m,i,o,s,v]}class Ie extends zt{constructor(t){super(),Ut(this,t,Be,We,Yt,{file:5,plugin:6,leaf:7})}}var y={};Object.defineProperty(y,"__esModule",{value:!0});var L=g;const wt="YYYY-MM-DD",yt="gggg-[W]ww",Kt="YYYY-MM",Jt="YYYY-[Q]Q",Xt="YYYY";function Q(e){var n,i;const t=window.app.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n[e])==null?void 0:i.enabled)}function Z(){var e,t,n,i;try{const{internalPlugins:o,plugins:s}=window.app;if(Q("daily")){const{format:c,folder:f,template:d}=((t=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.daily)||{};return{format:c||wt,folder:(f==null?void 0:f.trim())||"",template:(d==null?void 0:d.trim())||""}}const{folder:r,format:a,template:l}=((i=(n=o.getPluginById("daily-notes"))==null?void 0:n.instance)==null?void 0:i.options)||{};return{format:a||wt,folder:(r==null?void 0:r.trim())||"",template:(l==null?void 0:l.trim())||""}}catch{}}function G(){var e,t,n,i,o,s,r;try{const a=window.app.plugins,l=(e=a.getPlugin("calendar"))==null?void 0:e.options,c=(n=(t=a.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.weekly;if(Q("weekly"))return{format:c.format||yt,folder:((i=c.folder)==null?void 0:i.trim())||"",template:((o=c.template)==null?void 0:o.trim())||""};const f=l||{};return{format:f.weeklyNoteFormat||yt,folder:((s=f.weeklyNoteFolder)==null?void 0:s.trim())||"",template:((r=f.weeklyNoteTemplate)==null?void 0:r.trim())||""}}catch{}}function K(){var t,n,i,o;const e=window.app.plugins;try{const s=Q("monthly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.monthly)||{};return{format:s.format||Kt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function J(){var t,n,i,o;const e=window.app.plugins;try{const s=Q("quarterly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.quarterly)||{};return{format:s.format||Jt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function X(){var t,n,i,o;const e=window.app.plugins;try{const s=Q("yearly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.yearly)||{};return{format:s.format||Xt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function te(...e){let t=[];for(let i=0,o=e.length;i<o;i++)t=t.concat(e[i].split("/"));const n=[];for(let i=0,o=t.length;i<o;i++){const s=t[i];!s||s==="."||n.push(s)}return t[0]===""&&n.unshift(""),n.join("/")}function Ye(e){let t=e.substring(e.lastIndexOf("/")+1);return t.lastIndexOf(".")!=-1&&(t=t.substring(0,t.lastIndexOf("."))),t}async function Re(e){const t=e.replace(/\\/g,"/").split("/");if(t.pop(),t.length){const n=te(...t);window.app.vault.getAbstractFileByPath(n)||await window.app.vault.createFolder(n)}}async function tt(e,t){t.endsWith(".md")||(t+=".md");const n=L.normalizePath(te(e,t));return await Re(n),n}async function q(e){const{metadataCache:t,vault:n}=window.app,i=L.normalizePath(e);if(i==="/")return Promise.resolve(["",null]);try{const o=t.getFirstLinkpathDest(i,""),s=await n.cachedRead(o),r=window.app.foldManager.load(o);return[s,r]}catch(o){return console.error(`Failed to read the daily note template '${i}'`,o),new L.Notice("Failed to read the daily note template"),["",null]}}function F(e,t="day"){const n=e.clone().startOf(t).format();return`${t}-${n}`}function ee(e){return e.replace(/\[[^\]]*\]/g,"")}function je(e,t){if(t==="week"){const n=ee(e);return/w{1,2}/i.test(n)&&(/M{1,4}/.test(n)||/D{1,4}/.test(n))}return!1}function V(e,t){return ne(e.basename,t)}function qe(e,t){return ne(Ye(e),t)}function ne(e,t){const i={day:Z,week:G,month:K,quarter:J,year:X}[t]().format.split("/").pop(),o=window.moment(e,i,!0);if(!o.isValid())return null;if(je(i,t)&&t==="week"){const s=ee(i);if(/w{1,2}/i.test(s))return window.moment(e,i.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return o}class Ve extends Error{}async function ie(e){const t=window.app,{vault:n}=t,i=window.moment,{template:o,format:s,folder:r}=Z(),[a,l]=await q(o),c=e.format(s),f=await tt(r,c);try{const d=await n.create(f,a.replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,i().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,m,v,w,p,h)=>{const b=i(),S=e.clone().set({hour:b.get("hour"),minute:b.get("minute"),second:b.get("second")});return v&&S.add(parseInt(w,10),p),h?S.format(h.substring(1).trim()):S.format(s)}).replace(/{{\s*yesterday\s*}}/gi,e.clone().subtract(1,"day").format(s)).replace(/{{\s*tomorrow\s*}}/gi,e.clone().add(1,"d").format(s)));return t.foldManager.save(d,l),d}catch(d){console.error(`Failed to create file: '${f}'`,d),new L.Notice("Unable to create new file.")}}function Ue(e,t){return t[F(e,"day")]??null}function ze(){const{vault:e}=window.app,{folder:t}=Z(),n=e.getAbstractFileByPath(L.normalizePath(t));if(!n)throw new Ve("Failed to find daily notes folder");const i={};return L.Vault.recurseChildren(n,o=>{if(o instanceof L.TFile){const s=V(o,"day");if(s){const r=F(s,"day");i[r]=o}}}),i}class Qe extends Error{}function Ze(){const{moment:e}=window;let t=e.localeData()._week.dow;const n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;t;)n.push(n.shift()),t--;return n}function Ge(e){return Ze().indexOf(e.toLowerCase())}async function oe(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=G(),[s,r]=await q(n),a=e.format(i),l=await tt(o,a);try{const c=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,d,u,m,v,w)=>{const p=window.moment(),h=e.clone().set({hour:p.get("hour"),minute:p.get("minute"),second:p.get("second")});return u&&h.add(parseInt(m,10),v),w?h.format(w.substring(1).trim()):h.format(i)}).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(f,d,u)=>{const m=Ge(d);return e.weekday(m).format(u.trim())}));return window.app.foldManager.save(c,r),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new L.Notice("Unable to create new file.")}}function Ke(e,t){return t[F(e,"week")]??null}function Je(){const e={};if(!re())return e;const{vault:t}=window.app,{folder:n}=G(),i=t.getAbstractFileByPath(L.normalizePath(n));if(!i)throw new Qe("Failed to find weekly notes folder");return L.Vault.recurseChildren(i,o=>{if(o instanceof L.TFile){const s=V(o,"week");if(s){const r=F(s,"week");e[r]=o}}}),e}class Xe extends Error{}async function se(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=K(),[s,r]=await q(n),a=e.format(i),l=await tt(o,a);try{const c=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,d,u,m,v,w)=>{const p=window.moment(),h=e.clone().set({hour:p.get("hour"),minute:p.get("minute"),second:p.get("second")});return u&&h.add(parseInt(m,10),v),w?h.format(w.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(c,r),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new L.Notice("Unable to create new file.")}}function tn(e,t){return t[F(e,"month")]??null}function en(){const e={};if(!ae())return e;const{vault:t}=window.app,{folder:n}=K(),i=t.getAbstractFileByPath(L.normalizePath(n));if(!i)throw new Xe("Failed to find monthly notes folder");return L.Vault.recurseChildren(i,o=>{if(o instanceof L.TFile){const s=V(o,"month");if(s){const r=F(s,"month");e[r]=o}}}),e}class nn extends Error{}async function on(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=J(),[s,r]=await q(n),a=e.format(i),l=await tt(o,a);try{const c=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,d,u,m,v,w)=>{const p=window.moment(),h=e.clone().set({hour:p.get("hour"),minute:p.get("minute"),second:p.get("second")});return u&&h.add(parseInt(m,10),v),w?h.format(w.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(c,r),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new L.Notice("Unable to create new file.")}}function sn(e,t){return t[F(e,"quarter")]??null}function rn(){const e={};if(!le())return e;const{vault:t}=window.app,{folder:n}=J(),i=t.getAbstractFileByPath(L.normalizePath(n));if(!i)throw new nn("Failed to find quarterly notes folder");return L.Vault.recurseChildren(i,o=>{if(o instanceof L.TFile){const s=V(o,"quarter");if(s){const r=F(s,"quarter");e[r]=o}}}),e}class an extends Error{}async function ln(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=X(),[s,r]=await q(n),a=e.format(i),l=await tt(o,a);try{const c=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,d,u,m,v,w)=>{const p=window.moment(),h=e.clone().set({hour:p.get("hour"),minute:p.get("minute"),second:p.get("second")});return u&&h.add(parseInt(m,10),v),w?h.format(w.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(c,r),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new L.Notice("Unable to create new file.")}}function cn(e,t){return t[F(e,"year")]??null}function dn(){const e={};if(!ce())return e;const{vault:t}=window.app,{folder:n}=X(),i=t.getAbstractFileByPath(L.normalizePath(n));if(!i)throw new an("Failed to find yearly notes folder");return L.Vault.recurseChildren(i,o=>{if(o instanceof L.TFile){const s=V(o,"year");if(s){const r=F(s,"year");e[r]=o}}}),e}function fn(){var i,o;const{app:e}=window,t=e.internalPlugins.plugins["daily-notes"];if(t&&t.enabled)return!0;const n=e.plugins.getPlugin("periodic-notes");return n&&((o=(i=n.settings)==null?void 0:i.daily)==null?void 0:o.enabled)}function re(){var n,i;const{app:e}=window;if(e.plugins.getPlugin("calendar"))return!0;const t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.weekly)==null?void 0:i.enabled)}function ae(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.monthly)==null?void 0:i.enabled)}function le(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.quarterly)==null?void 0:i.enabled)}function ce(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.yearly)==null?void 0:i.enabled)}function un(e){const t={day:Z,week:G,month:K,quarter:J,year:X}[e];return t()}function hn(e,t){return{day:ie,month:se,week:oe}[e](t)}var Dt=y.DEFAULT_DAILY_NOTE_FORMAT=wt;y.DEFAULT_MONTHLY_NOTE_FORMAT=Kt;y.DEFAULT_QUARTERLY_NOTE_FORMAT=Jt;y.DEFAULT_WEEKLY_NOTE_FORMAT=yt;y.DEFAULT_YEARLY_NOTE_FORMAT=Xt;y.appHasDailyNotesPluginLoaded=fn;y.appHasMonthlyNotesPluginLoaded=ae;y.appHasQuarterlyNotesPluginLoaded=le;y.appHasWeeklyNotesPluginLoaded=re;y.appHasYearlyNotesPluginLoaded=ce;var pn=y.createDailyNote=ie;y.createMonthlyNote=se;y.createPeriodicNote=hn;y.createQuarterlyNote=on;y.createWeeklyNote=oe;y.createYearlyNote=ln;var gn=y.getAllDailyNotes=ze;y.getAllMonthlyNotes=en;y.getAllQuarterlyNotes=rn;y.getAllWeeklyNotes=Je;y.getAllYearlyNotes=dn;var mn=y.getDailyNote=Ue,Tt=y.getDailyNoteSettings=Z,Nt=y.getDateFromFile=V;y.getDateFromPath=qe;y.getDateUID=F;y.getMonthlyNote=tn;y.getMonthlyNoteSettings=K;y.getPeriodicNoteSettings=un;y.getQuarterlyNote=sn;y.getQuarterlyNoteSettings=J;y.getTemplateInfo=q;y.getWeeklyNote=Ke;y.getWeeklyNoteSettings=G;y.getYearlyNote=cn;y.getYearlyNoteSettings=X;function Ot(e,t,n){const i=e.slice();return i[19]=t[n],i}function At(e){let t;return{c(){t=P("div"),$(t,"class","dn-stock svelte-101lm3m")},m(n,i){H(n,t,i)},d(n){n&&T(t)}}}function Ht(e){let t,n,i;return{c(){t=P("div"),t.innerHTML='<div class="dn-blank-day-text svelte-101lm3m">Create a daily note for today ✍</div>',$(t,"class","dn-blank-day svelte-101lm3m"),$(t,"aria-hidden","true")},m(o,s){H(o,t,s),n||(i=R(t,"click",e[5]),n=!0)},p:A,d(o){o&&T(t),n=!1,i()}}}function Wt(e,t){let n,i,o;return i=new Ie({props:{file:t[19],plugin:t[0],leaf:t[1]}}),{key:e,first:null,c(){n=he(),Le(i.$$.fragment),this.first=n},m(s,r){H(s,n,r),qt(i,s,r),o=!0},p(s,r){t=s;const a={};r&8&&(a.file=t[19]),r&1&&(a.plugin=t[0]),r&2&&(a.leaf=t[1]),i.$set(a)},i(s){o||(ct(i.$$.fragment,s),o=!0)},o(s){Et(i.$$.fragment,s),o=!1},d(s){s&&T(n),Vt(i,s)}}}function Bt(e){let t;return{c(){t=P("div"),t.textContent="—— No more of results ——",$(t,"class","no-more-text svelte-101lm3m")},m(n,i){H(n,t,i)},d(n){n&&T(t)}}}function wn(e){let t,n,i,o=[],s=new Map,r,a,l,c,f,d,u=e[3].length===0&&At(),m=!e[4]&&Ht(e),v=Ct(e[3]);const w=h=>h[19];for(let h=0;h<v.length;h+=1){let b=Ot(e,v,h),S=w(b);s.set(S,o[h]=Wt(S,b))}let p=!e[2]&&Bt();return{c(){t=P("div"),u&&u.c(),n=N(),m&&m.c(),i=N();for(let h=0;h<o.length;h+=1)o[h].c();r=N(),a=P("div"),l=N(),p&&p.c(),$(t,"class","daily-note-view")},m(h,b){H(h,t,b),u&&u.m(t,null),x(t,n),m&&m.m(t,null),x(t,i);for(let S=0;S<o.length;S+=1)o[S]&&o[S].m(t,null);x(t,r),x(t,a),x(t,l),p&&p.m(t,null),c=!0,f||(d=[Rt(Gt.call(null,a,{})),R(a,"inview_init",e[6]),R(a,"inview_change",e[8]),R(a,"inview_leave",e[7])],f=!0)},p(h,[b]){h[3].length===0?u||(u=At(),u.c(),u.m(t,n)):u&&(u.d(1),u=null),h[4]?m&&(m.d(1),m=null):m?m.p(h,b):(m=Ht(h),m.c(),m.m(t,i)),b&11&&(v=Ct(h[3]),ke(),o=Se(o,b,w,1,h,v,s,t,Ee,Wt,r,Ot),be()),h[2]?p&&(p.d(1),p=null):p||(p=Bt(),p.c(),p.m(t,null))},i(h){if(!c){for(let b=0;b<v.length;b+=1)ct(o[b]);c=!0}},o(h){for(let b=0;b<o.length;b+=1)Et(o[b]);c=!1},d(h){h&&T(t),u&&u.d(),m&&m.d();for(let b=0;b<o.length;b+=1)o[b].d();p&&p.d(),f=!1,D(d)}}}const yn=1;function vn(e,t,n){let{plugin:i}=t,{leaf:o}=t,s,r,a=[],l=[],c=!0,f=!1,d=!0;function u(){const E=g.moment();mn(E,r)||n(4,d=!1)}function m(){return Ce(this,void 0,void 0,function*(){const E=g.moment();if(!d){const k=yield pn(E);l.push(k),n(3,l=S(l)),n(4,d=!0)}})}function v(){s||(s=setInterval(p,100))}function w(){clearInterval(s),s=null}function p(){!f||!c||(a.length===0&&f?n(2,c=!1):n(3,l=[...l,...a.splice(0,yn)]))}function h(){n(3,l)}function b(){u()}function S(E){const k=Tt().format||Dt;return E.sort((_,C)=>g.moment(C.basename,k).valueOf()-g.moment(_.basename,k).valueOf())}function et(E){const k=Nt(E,"day"),_=Tt().format||Dt;if(!k)return;if(l.length===0){a.push(E),n(14,a=S(a));return}const C=l[l.length-1],W=l[0],St=g.moment(C.basename,_),Lt=g.moment(W.basename,_);k.isBetween(St,Lt)?(l.push(E),n(3,l=S(l))):k.isBefore(St)?(a.push(E),n(14,a=S(a))):k.isAfter(Lt)&&(l.push(E),n(3,l=S(l))),k.isSame(g.moment(),"day")&&n(4,d=!0)}function nt(E){Nt(E,"day")&&(n(3,l=l.filter(k=>k.basename!==E.basename)),n(14,a=a.filter(k=>k.basename!==E.basename)),u())}return e.$$set=E=>{"plugin"in E&&n(0,i=E.plugin),"leaf"in E&&n(1,o=E.leaf)},e.$$.update=()=>{if(e.$$.dirty&57348&&c&&!f){n(13,r=gn());for(const E of Object.keys(r).sort().reverse())a.push(r[E]);n(15,f=!0),u()}},[i,o,c,l,d,m,v,w,p,h,b,et,nt,r,a,f]}class kn extends zt{constructor(t){super(),Ut(this,t,vn,wn,Yt,{plugin:0,leaf:1,tick:9,check:10,fileCreate:11,fileDelete:12})}get tick(){return this.$$.ctx[9]}get check(){return this.$$.ctx[10]}get fileCreate(){return this.$$.ctx[11]}get fileDelete(){return this.$$.ctx[12]}}function rt(e,t){const n=Object.keys(t).map(i=>bn(e,i,t[i]));return n.length===1?n[0]:function(){n.forEach(i=>i())}}function bn(e,t,n){const i=e[t],o=e.hasOwnProperty(t);let s=n(i);return i&&Object.setPrototypeOf(s,i),Object.setPrototypeOf(r,s),e[t]=r,a;function r(...l){return s===i&&e[t]===r&&a(),s.apply(this,l)}function a(){e[t]===r&&(o?e[t]=i:delete e[t]),s!==i&&(s=i,Object.setPrototypeOf(r,i||Function))}}const En=()=>{g.addIcon("daily-note",'<svg width="103" height="134" viewBox="0 0 103 134" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M60.3446 21.848H22.5577C19.5764 21.848 17.1595 24.2648 17.1595 27.2462V65.0331C17.1595 68.0144 19.5764 70.4312 22.5577 70.4312H60.3446C63.3259 70.4312 65.7428 68.0144 65.7428 65.0331V27.2462C65.7428 24.2648 63.3259 21.848 60.3446 21.848Z" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M52.2476 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M30.655 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.1595 38.0424H65.7428" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M33.3541 54.2366L38.7523 59.6348L49.5485 48.8385" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><g filter="url(#filter0_ddddd_104_2)"><path d="M12.181 103.617L9.21851 95.8213L27.9292 87.0896L66.754 71.4973L93.1049 88.8047L91.3898 103.617H12.181Z" fill="#AC4DD9" stroke="black" stroke-width="0.963236"/><path d="M12.181 103.617L9.21851 95.9771L27.9292 87.0895L32.6069 103.461L12.181 103.617Z" fill="#540D75" stroke="black" stroke-width="0.963236"/><path d="M9.0625 95.6652L25.7894 67.212L27.9291 87.0894L9.21842 95.977L9.0625 95.6652Z" fill="#470068" stroke="black" stroke-width="0.481618"/><path d="M27.9291 87.0896L25.9021 66.8197L67.5335 56.2169L66.5979 71.4973L27.9291 87.0896Z" fill="#732E94" stroke="black" stroke-width="0.963236"/><path d="M66.598 71.4971L67.9466 56.3527L93.1049 88.8045L66.598 71.4971Z" fill="#C279E4" stroke="black" stroke-width="0.481618"/><path d="M9.0625 95.6652L25.7462 66.8195L67.9465 56.0808L93.1049 88.8046L66.598 71.4972L27.9291 87.0895L9.21842 95.9771L9.0625 95.6652Z" stroke="black" stroke-width="0.963236"/><path d="M26.0579 103.617L27.9289 87.0895L32.7625 103.617H26.0579Z" fill="#61018E" stroke="black" stroke-width="0.963236"/></g><defs><filter id="filter0_ddddd_104_2" x="0.0874329" y="53.8502" width="101.958" height="79.8707" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1.20405"/><feGaussianBlur stdDeviation="1.44485"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="effect1_dropShadow_104_2" result="effect2_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="5.2978"/><feGaussianBlur stdDeviation="2.6489"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"/><feBlend mode="normal" in2="effect2_dropShadow_104_2" result="effect3_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="11.7996"/><feGaussianBlur stdDeviation="3.61213"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"/><feBlend mode="normal" in2="effect3_dropShadow_104_2" result="effect4_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="21.1912"/><feGaussianBlur stdDeviation="4.21416"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01 0"/><feBlend mode="normal" in2="effect4_dropShadow_104_2" result="effect5_dropShadow_104_2"/><feBlend mode="normal" in="SourceGraphic" in2="effect5_dropShadow_104_2" result="shape"/></filter></defs></svg>')},Sn={hideFrontmatter:!1,hideBacklinks:!1};class Ln extends g.PluginSettingTab{constructor(t,n){super(t,n),this.debounceApplySettingsUpdate=g.debounce(async()=>{await this.plugin.saveSettings()},200,!0),this.debounceDisplay=g.debounce(async()=>{await this.display()},400,!0),this.plugin=n}applySettingsUpdate(){this.debounceApplySettingsUpdate()}async display(){await this.plugin.loadSettings();const{containerEl:t}=this,n=this.plugin.settings;t.toggleClass("daily-note-settings-container",!0),t.empty(),new g.Setting(t).setName("Hide frontmatter").setDesc("Hide frontmatter in daily notes").addToggle(i=>i.setValue(n.hideFrontmatter).onChange(async o=>{this.plugin.settings.hideFrontmatter=o,document.body.classList.toggle("daily-notes-hide-frontmatter",o),this.applySettingsUpdate()})),new g.Setting(t).setName("Hide backlinks").setDesc("Hide backlinks in daily notes").addToggle(i=>i.setValue(n.hideBacklinks).onChange(async o=>{this.plugin.settings.hideBacklinks=o,document.body.classList.toggle("daily-notes-hide-backlinks",o),this.applySettingsUpdate()}))}}const Y="daily-note-editor-view";function _n(e){return e.containerEl.matches(".dn-leaf-view")}class $n extends g.ItemView{constructor(t,n){super(t),this.onFileCreate=i=>{i instanceof g.TFile&&this.view.fileCreate(i)},this.onFileDelete=i=>{i instanceof g.TFile&&this.view.fileDelete(i)},this.plugin=n,this.scope=new g.Scope(n.app.scope)}getViewType(){return Y}getDisplayText(){return"Daily Note"}getIcon(){return"daily-note"}async onOpen(){this.scope.register(["Mod"],"f",t=>{}),this.view=new kn({target:this.contentEl,props:{plugin:this.plugin,leaf:this.leaf}}),this.app.vault.on("create",this.onFileCreate),this.app.vault.on("delete",this.onFileDelete),this.app.workspace.onLayoutReady(this.view.tick.bind(this)),this.registerInterval(window.setInterval(async()=>{this.view.check()},1e3*60*60))}}class Cn extends g.Plugin{async onload(){this.addSettingTab(new Ln(this.app,this)),await this.loadSettings(),this.patchWorkspace(),this.patchWorkspaceLeaf(),En(),this.registerView(Y,t=>this.view=new $n(t,this)),this.addRibbonIcon("daily-note","Open Daily Note Editor",t=>this.openDailyNoteEditor()),this.addCommand({id:"open-daily-note-editor",name:"Open Daily Note Editor",callback:()=>this.openDailyNoteEditor()}),this.initCssRules()}onunload(){this.app.workspace.detachLeavesOfType(Y),document.body.toggleClass("daily-notes-hide-frontmatter",!1),document.body.toggleClass("daily-notes-hide-backlinks",!1)}async openDailyNoteEditor(){const t=this.app.workspace;t.detachLeavesOfType(Y);const n=t.getLeaf(!0);await n.setViewState({type:Y}),t.revealLeaf(n)}initCssRules(){document.body.toggleClass("daily-notes-hide-frontmatter",this.settings.hideFrontmatter),document.body.toggleClass("daily-notes-hide-backlinks",this.settings.hideBacklinks)}patchWorkspace(){let t=!1;const n=rt(g.Workspace.prototype,{changeLayout(i){return async function(o){t=!0;try{await i.call(this,o)}finally{t=!1}}},iterateLeaves(i){return function(o,s){if(i.call(this,o,s))return!0;const r=typeof o=="function"?o:s,a=typeof o=="function"?s:o;if(!a||t)return!1;if(a===app.workspace.rootSplit||g.WorkspaceContainer&&a instanceof g.WorkspaceContainer){for(const l of z.popoversForWindow(a.win))if(i.call(this,r,l.rootSplit))return!0}return!1}},setActiveLeaf:i=>function(o,s){if(o.parentLeaf){o.parentLeaf.activeTime=17e11,i.call(this,o.parentLeaf,s),o.view.editMode&&(this.activeEditor=o.view);return}i.call(this,o,s)},onDragLeaf(i){return function(o,s){return i.call(this,o,s)}}});this.register(n)}patchWorkspaceLeaf(){this.register(rt(g.WorkspaceLeaf.prototype,{getRoot(t){return function(){const n=t.call(this);return(n==null?void 0:n.getRoot)===this.getRoot?n:n==null?void 0:n.getRoot()}},setPinned(t){return function(n){t.call(this,n),xt(this)&&!n&&this.setPinned(!0)}},openFile(t){return function(n,i){if(xt(this)){setTimeout(rt(g.Workspace.prototype,{recordMostRecentOpenedFile(s){return function(r){if(r!==n)return s.call(this,r)}}}),1);const o=this.app.plugins.plugins["recent-files-obsidian"];o&&setTimeout(rt(o,{shouldAddFile(s){return function(r){return r!==n&&s.call(this,r)}}}),1)}return t.call(this,n,i)}}}))}async loadSettings(){this.settings=Object.assign({},Sn,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}}exports.DAILY_NOTE_VIEW_TYPE=Y;exports.default=Cn;exports.isEmebeddedLeaf=_n;
