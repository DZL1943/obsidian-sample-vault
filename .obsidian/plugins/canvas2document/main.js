/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Canvas2DocumentPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var path = __toESM(require("path"));
var Canvas2DocumentPlugin = class extends import_obsidian.Plugin {
  async onload() {
    if (this.app.vault.adapter instanceof import_obsidian.FileSystemAdapter) {
      this.fsadapter = this.app.vault.adapter;
    } else {
      return;
    }
    this.addCommand({
      id: "run-conversion",
      name: "Convert canvas to a longform document",
      callback: async () => {
        const canvStruct = await this.readCanvasStruct();
        if (canvStruct == false) {
          new import_obsidian.Notice(`this is not a canvas file`);
          return;
        }
        const contents = await this.readCanvasData(canvStruct);
        const result = await this.writeCanvDocFile(contents, canvStruct);
      }
    });
    this.addCommand({
      id: "run-redoc",
      name: "Clear canvas2document target document",
      callback: async () => {
        const canvStruct = await this.readC2Dtarget();
        if (canvStruct == false) {
          new import_obsidian.Notice(`this is not a canvas2document target file`);
          return;
        }
        this.writeC2Doc(canvStruct);
      }
    });
  }
  onunload() {
  }
  async readC2Dtarget() {
    let activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || !activeFile.name.includes("_fromCanvas.md")) {
      return false;
    } else {
      let mdFolderPath = path.dirname(activeFile.path);
    }
    let content = this.app.vault.cachedRead(activeFile);
    return content;
  }
  async writeC2Doc(canvStruct) {
    let activeFile = this.app.workspace.getActiveFile();
    let mdFolderPath = path.dirname(activeFile.path);
    const pattern = /\!\[\[([^[\]]+)\]\]/g;
    const matches = canvStruct.match(pattern);
    let doccontentstring = "> [!success] This is your converted and cleared document from Canvas2Document\n> (you can delete this infobox)\n\n";
    if (!matches) {
      return;
    }
    let textfilenames = [];
    let filenames = [];
    matches.forEach((match) => {
      let embeddedfilename = match.replace(/\!\[\[(.*)\]\]/, "$1");
      if (embeddedfilename.endsWith(".md")) {
        if (embeddedfilename.startsWith("./")) {
          embeddedfilename = embeddedfilename.replace("./", "");
        }
        textfilenames.push(embeddedfilename);
      }
      filenames.push(embeddedfilename);
    });
    const fileContents = await Promise.all(
      textfilenames.map(
        async (file) => [file, await this.app.vault.cachedRead(this.app.vault.getAbstractFileByPath(file))]
      )
    );
    for (const xfile of filenames) {
      if (xfile.endsWith(".md")) {
        const found = fileContents.find((element) => element[0] == xfile);
        const { dir, name, ext } = path.parse(xfile);
        if (!dir.endsWith("_canvas2doc-data")) {
          doccontentstring += "# " + name + "\n\n";
        }
        doccontentstring += found[1] + "\n\n";
      } else {
        doccontentstring += "![[" + xfile + "]]\n\n";
      }
    }
    let docFilename;
    if (mdFolderPath == ".") {
      docFilename = activeFile.basename + "_" + Math.round(new Date().getTime() / 1e3) + "_fromC2D.md";
    } else {
      docFilename = mdFolderPath + "/" + activeFile.basename + "_" + Math.round(new Date().getTime() / 1e3) + "_fromC2D.md";
    }
    try {
      await this.app.vault.create(docFilename, doccontentstring);
    } catch (e) {
      console.log("error writing the new cleare doc file " + e);
    }
    const docftab = await this.app.vault.getAbstractFileByPath(docFilename);
    try {
      await this.app.workspace.getLeaf("split").openFile(docftab);
    } catch (e) {
      console.log(e);
    }
    return;
  }
  async readCanvasStruct() {
    let activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || activeFile.extension != "canvas") {
      return false;
    } else {
      let mdFolderPath = path.dirname(activeFile.path);
    }
    let content = this.app.vault.cachedRead(activeFile);
    return content;
  }
  // TODO diese wird die findDefinedChildren, nicht rekursiver call, sondern 2-3 mal -> 5 Mal like headings
  // dann der Rest Ã¼ber findAllXChrildren wird dann der letzten Ebene noch zugeordnet
  async findAllXChildren(startGeneration, myparsed_data, fileContents, handledNodes, limitrecurseNodes, runcounterfunc, runcounterforeach) {
    runcounterfunc++;
    if (runcounterfunc > 30) {
      return false;
    }
    for (const child of startGeneration) {
      runcounterforeach++;
      if (runcounterforeach > myparsed_data.edges.length) {
        return false;
      }
      const nodeentry = myparsed_data.nodes.find((entry) => entry.id === child);
      if (!handledNodes.has(child)) {
        const result = await this.formatNode(nodeentry, 6);
        fileContents.push(result);
        handledNodes.add(child);
      } else {
        limitrecurseNodes++;
        if (limitrecurseNodes > 30) {
          return false;
        }
      }
      let children = myparsed_data.edges.filter((edge) => edge.fromNode === child).map((edge) => edge.toNode);
      if (children.length > 0) {
        const continueRecursion = await this.findAllXChildren(children, myparsed_data, fileContents, handledNodes, limitrecurseNodes, runcounterfunc, runcounterforeach);
        if (!continueRecursion)
          return false;
      }
    }
    ;
    limitrecurseNodes++;
    return limitrecurseNodes <= 30;
  }
  async traverseNodes(initialNodes, myparsed_data, fileContents, handledNodes) {
    for (const node of initialNodes) {
      const nodeentry = myparsed_data.nodes.find((entry) => entry.id === node);
      if (!handledNodes.has(node)) {
        const result = await this.formatNode(nodeentry, 1);
        fileContents.push(result);
      }
      handledNodes.add(node);
      const children1 = myparsed_data.edges.filter((edge) => edge.fromNode === node).map((edge) => edge.toNode);
      for (const child1 of children1) {
        const nodeentry2 = myparsed_data.nodes.find((entry) => entry.id === child1);
        if (!handledNodes.has(child1)) {
          const result = await this.formatNode(nodeentry2, 2);
          fileContents.push(result);
        }
        handledNodes.add(child1);
        const children2 = myparsed_data.edges.filter((edge) => edge.fromNode === child1).map((edge) => edge.toNode);
        for (const child2 of children2) {
          const nodeentry3 = myparsed_data.nodes.find((entry) => entry.id === child2);
          if (!handledNodes.has(child2)) {
            const result = await this.formatNode(nodeentry3, 3);
            fileContents.push(result);
          }
          handledNodes.add(child2);
          const children3 = myparsed_data.edges.filter((edge) => edge.fromNode === child2).map((edge) => edge.toNode);
          for (const child3 of children3) {
            const nodeentry4 = myparsed_data.nodes.find((entry) => entry.id === child3);
            if (!handledNodes.has(child3)) {
              const result = await this.formatNode(nodeentry4, 4);
              fileContents.push(result);
            }
            handledNodes.add(child3);
            const children4 = myparsed_data.edges.filter((edge) => edge.fromNode === child3).map((edge) => edge.toNode);
            for (const child4 of children4) {
              const nodeentry5 = myparsed_data.nodes.find((entry) => entry.id === child4);
              if (!handledNodes.has(child4)) {
                const result = await this.formatNode(nodeentry5, 5);
                fileContents.push(result);
              }
              handledNodes.add(child4);
              const children5 = myparsed_data.edges.filter((edge) => edge.fromNode === child4).map((edge) => edge.toNode);
              for (const child5 of children5) {
                const nodeentry6 = myparsed_data.nodes.find((entry) => entry.id === child5);
                if (!handledNodes.has(child5)) {
                  const result2 = await this.formatNode(nodeentry6, 6);
                  fileContents.push(result2);
                }
                handledNodes.add(child5);
                const children6 = myparsed_data.edges.filter((edge) => edge.fromNode === child5).map((edge) => edge.toNode);
                let runcounterfunc = 0;
                let runcounterforeach = 0;
                let limitrecurseNodes = 0;
                const result = await this.findAllXChildren(children6, myparsed_data, fileContents, handledNodes, limitrecurseNodes, runcounterfunc, runcounterforeach);
              }
            }
          }
        }
      }
    }
  }
  async readCanvasData(struct) {
    const fileContents = [];
    let myparsed_data = JSON.parse(struct);
    const singleNodeIDs = /* @__PURE__ */ new Set();
    const groupNodes = /* @__PURE__ */ new Set();
    myparsed_data.nodes.forEach((node) => {
      if (node.type === "group") {
        groupNodes.add(node.id);
      } else {
        singleNodeIDs.add(node.id);
      }
    });
    const fromNodes = /* @__PURE__ */ new Set();
    const toNodes = /* @__PURE__ */ new Set();
    myparsed_data.edges.forEach((edge) => {
      if (groupNodes.has(edge.fromNode) || groupNodes.has(edge.toNode)) {
        return;
      }
      fromNodes.add(edge.fromNode);
      toNodes.add(edge.toNode);
    });
    let handledNodes = /* @__PURE__ */ new Set();
    const skiphandledNodes = true;
    let nodesWithoutParents = [...singleNodeIDs].filter((node) => !toNodes.has(node));
    if (nodesWithoutParents.length === 0) {
      nodesWithoutParents = [...singleNodeIDs];
    }
    const traverseresult = await this.traverseNodes(nodesWithoutParents, myparsed_data, fileContents, handledNodes);
    const diff = new Set([...singleNodeIDs].filter((x) => !handledNodes.has(x)));
    if (diff.size > 0) {
      const traverseresult2 = await this.traverseNodes(diff, myparsed_data, fileContents, handledNodes);
    }
    return fileContents;
  }
  async formatNode(node, level) {
    const id = node.id;
    const type = node.type;
    let nodefile = "";
    if (type === "file") {
      nodefile = node.file;
      const { name, ext } = path.parse(nodefile);
      if (ext === ".md") {
        return [id, type, nodefile, level, "textfile", name];
      } else if (ext === ".jpg" || ext == ".jpeg" || ext === ".png" || ext === ".gif") {
        return [id, type, nodefile, level, "contentimage", name + "." + ext];
      } else if (ext === ".pdf") {
        return [id, type, nodefile, level, "contentpdf", name + "." + ext];
      } else {
      }
    } else if (type === "link") {
      if (node.url.includes("youtube")) {
        const url = node.url;
        return [id, type, url, level, "contentyoutube", node.url];
      } else {
        return [id, type, node.url, level, "contentlink", node.url];
      }
    } else if (type === "text") {
      const text = node.text;
      const textPreview = text.substring(0, 100);
      return [id, type, "node", level, text, textPreview];
    }
  }
  async writeCanvDocFile(content, convStruct) {
    let activeFile = this.app.workspace.getActiveFile();
    let mdFolderPath = path.dirname(activeFile.path);
    let writeworkdir = mdFolderPath + "/" + activeFile.basename + "_canvas2doc-data";
    this.fsadapter.mkdir(writeworkdir);
    let canvasFile;
    let canvasFilename;
    if (mdFolderPath == ".") {
      canvasFilename = activeFile.basename + "_" + Math.round(new Date().getTime() / 1e3) + "_fromCanvas.md";
    } else {
      canvasFilename = mdFolderPath + "/" + activeFile.basename + "_" + Math.round(new Date().getTime() / 1e3) + "_fromCanvas.md";
    }
    let contentString = "> [!info] This is an automatically generated document from Plugin [Canvas2Document](https://github.com/slnsys/obsidian-canvas2document)\n> arrange the document as you need with the outline, then call *Clear canvas2document target document*\n\n";
    let myparsed_data = JSON.parse(convStruct);
    for (const element of content) {
      let cnfname = "";
      let heading = "";
      for (let i = 0; i < element[3]; i++) {
        heading += "#";
      }
      if (element[1] == "text") {
        cnfname = writeworkdir + "/newdoc-node_" + element[0] + "_fromCanvas.md";
        contentString += "\n\n" + heading + " _card " + element[5] + "\n";
        contentString += element[2] + " ^" + element[0] + "\n\n";
        contentString += "> [!tip] link navigation from the canvas\n";
        for (const edge of myparsed_data.edges) {
          if (edge.fromNode == element[0]) {
            const found = content.find((element2) => element2[0] == edge.toNode);
            const firstline = found[5].split("\n")[0];
            const found5 = firstline.replace(/#/g, "");
            contentString += "> linking to: [[#^" + edge.toNode + "|" + found5 + "]]\n";
          }
          if (edge.toNode == element[0]) {
            const found = content.find((element2) => element2[0] == edge.fromNode);
            const firstline = found[5].split("\n")[0];
            const found5 = firstline.replace(/#/g, "");
            contentString += "> linked from: [[#^" + edge.fromNode + "|" + found5 + "]]\n";
          }
        }
        contentString += "\n ![[" + cnfname + "]]\n\n";
      } else if (element[1] == "link") {
        contentString += "\n\n" + heading + " _link " + element[5] + "\n";
        contentString += element[2] + " ^" + element[0] + "\n\n";
        contentString += "> [!tip] link navigation from the canvas\n";
        for (const edge of myparsed_data.edges) {
          if (edge.fromNode == element[0]) {
            const found = content.find((element2) => element2[0] == edge.toNode);
            const firstline = found[5].split("\n")[0];
            const found5 = firstline.replace(/#/g, "");
            contentString += "> linking to: [[#^" + edge.toNode + "|" + found5 + "]]\n";
          }
          if (edge.toNode == element[0]) {
            const found = content.find((element2) => element2[0] == edge.fromNode);
            const firstline = found[5].split("\n")[0];
            const found5 = firstline.replace(/#/g, "");
            contentString += "> linked from: [[#^" + edge.fromNode + "|" + found5 + "]]\n";
          }
        }
        if (element[4] == "contentyoutube") {
          contentString += "\n ![](" + element[2] + ")\n\n";
        } else if (element[4] == "contentlink") {
          contentString += '\n <iframe src="' + element[2] + '"></iframe>\n\n';
        }
      } else if (element[1] == "file") {
        if (element[4] == "contentimage" || element[4] == "contentpdf") {
          contentString += "\n\n" + heading + " _Media " + element[5] + "\n";
          contentString += element[2] + " ^" + element[0] + "\n\n";
          contentString += "> [!tip] link navigation from the canvas\n";
          for (const edge of myparsed_data.edges) {
            if (edge.fromNode == element[0]) {
              const found = content.find((element2) => element2[0] == edge.toNode);
              const firstline = found[5].split("\n")[0];
              const found5 = firstline.replace(/#/g, "");
              contentString += "> linking to: [[#^" + edge.toNode + "|" + found5 + "]]\n";
            }
            if (edge.toNode == element[0]) {
              const found = content.find((element2) => element2[0] == edge.fromNode);
              const firstline = found[5].split("\n")[0];
              const found5 = firstline.replace(/#/g, "");
              contentString += "> linked from: [[#^" + edge.fromNode + "|" + found5 + "]]\n";
            }
          }
          if (element[4] == "contentpdf") {
            contentString += "\n ![[" + element[2] + "#height=500]]\n\n";
          } else if (element[4] == "contentimage") {
            contentString += "\n ![[" + element[2] + "|500]]\n\n";
          }
        } else {
          contentString += "\n\n" + heading + " _noteFile " + element[5] + "\n";
          contentString += element[2] + " ^" + element[0] + "\n\n";
          contentString += "> [!tip] link navigation from the canvas\n";
          for (const edge of myparsed_data.edges) {
            if (edge.fromNode == element[0]) {
              const found = content.find((element2) => element2[0] == edge.toNode);
              const firstline = found[5].split("\n")[0];
              const found5 = firstline.replace(/#/g, "");
              contentString += "> linking to: [[#^" + edge.toNode + "|" + found5 + "]]\n";
            }
            if (edge.toNode == element[0]) {
              const found = content.find((element2) => element2[0] == edge.fromNode);
              const firstline = found[5].split("\n")[0];
              const found5 = firstline.replace(/#/g, "");
              contentString += "> linked from: [[#^" + edge.fromNode + "|" + found5 + "]]\n";
            }
          }
          contentString += "\n ![[" + element[2] + "]]\n\n";
        }
      }
      let canvasnodeFile;
      try {
        let cnfabst2 = this.app.vault.getAbstractFileByPath(cnfname);
        this.app.vault.delete(cnfabst2, true);
        canvasnodeFile = this.app.vault.create(cnfname, element[4]);
      } catch (e) {
        console.log(e);
        return;
      }
    }
    try {
      canvasFile = await this.app.vault.create(canvasFilename, contentString);
    } catch (e) {
      console.log("error writing the new doc file " + e);
    }
    const cnfabst = await this.app.vault.getAbstractFileByPath(canvasFilename);
    try {
      await this.app.workspace.getLeaf("split").openFile(cnfabst);
    } catch (e) {
      console.log(e);
    }
    return true;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgbm9ybWFsaXplUGF0aCwgV29ya3NwYWNlLCBXb3Jrc3BhY2VMZWFmLCBURmlsZSwgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4sIEZpbGVTeXN0ZW1BZGFwdGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG4vLyBpbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCB7IGV4aXQgfSBmcm9tICdwcm9jZXNzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhczJEb2N1bWVudFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblx0ZnNhZGFwdGVyOiBGaWxlU3lzdGVtQWRhcHRlcjtcclxuXHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFxyXG5cdFx0Ly8gdGhpcy5mc2FkYXB0ZXIgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyIGFzIEZpbGVTeXN0ZW1BZGFwdGVyO1xyXG5cdFx0IGlmICh0aGlzLmFwcC52YXVsdC5hZGFwdGVyIGluc3RhbmNlb2YgRmlsZVN5c3RlbUFkYXB0ZXIpIHtcclxuXHRcdFx0dGhpcy5mc2FkYXB0ZXIgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyIGFzIEZpbGVTeXN0ZW1BZGFwdGVyO1xyXG5cdFx0IH0gZWxzZSB7XHJcblx0XHRcdC8vVE9ETyB0aHJvdyBleGNlcHRpb24gZm9yIGZzYWRhcHRlclxyXG5cdFx0XHRyZXR1cm5cclxuXHRcdCB9XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwicnVuLWNvbnZlcnNpb25cIixcclxuXHRcdFx0bmFtZTogXCJDb252ZXJ0IGNhbnZhcyB0byBhIGxvbmdmb3JtIGRvY3VtZW50XCIsXHJcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgY2FudlN0cnVjdCA9IGF3YWl0IHRoaXMucmVhZENhbnZhc1N0cnVjdCgpO1xyXG5cdFx0XHRcdGlmIChjYW52U3RydWN0ID09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKGB0aGlzIGlzIG5vdCBhIGNhbnZhcyBmaWxlYCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBjb250ZW50cyA9IGF3YWl0IHRoaXMucmVhZENhbnZhc0RhdGEoY2FudlN0cnVjdCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMud3JpdGVDYW52RG9jRmlsZShjb250ZW50cywgY2FudlN0cnVjdCk7XHJcblxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwicnVuLXJlZG9jXCIsXHJcblx0XHRcdG5hbWU6IFwiQ2xlYXIgY2FudmFzMmRvY3VtZW50IHRhcmdldCBkb2N1bWVudFwiLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGNhbnZTdHJ1Y3QgPSBhd2FpdCB0aGlzLnJlYWRDMkR0YXJnZXQoKTtcclxuXHRcdFx0XHRpZiAoY2FudlN0cnVjdCA9PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShgdGhpcyBpcyBub3QgYSBjYW52YXMyZG9jdW1lbnQgdGFyZ2V0IGZpbGVgKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy53cml0ZUMyRG9jKGNhbnZTdHJ1Y3QpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7XHJcblx0XHQvLyBUT0RPIGNsZWFuaW5nIHVwXHJcblx0fVxyXG5cclxuXHRhc3luYyByZWFkQzJEdGFyZ2V0KCk6IFByb21pc2U8bnVtYmVyPiB7XHJcblx0XHQvKlxyXG5cdFx0Y2hlY2sgb24gYWN0aXZlIGZpbGUgaXMgY2FudmFzXHJcblx0XHQqL1xyXG5cdFx0bGV0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuXHRcdC8vZmlsZW5hbWUgb2YgdGhlIGFjdGl2ZSBmaWxlIGNvbnRhaW5zIFwiX2Zyb21DYW52YXMubWRcIlxyXG5cdFx0aWYgKCFhY3RpdmVGaWxlIHx8ICFhY3RpdmVGaWxlLm5hbWUuaW5jbHVkZXMoXCJfZnJvbUNhbnZhcy5tZFwiKSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRsZXQgbWRGb2xkZXJQYXRoOiBzdHJpbmcgPSBwYXRoLmRpcm5hbWUoYWN0aXZlRmlsZS5wYXRoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBUT0RPOiBwcmV2ZW50IHJlYWRpbmcgYWxsIGZpbGVzLCBqdXN0IHRoZSBhY3RpdmUgZmlsZSwgaWYgY2FudmFzIGNoZWNrIG9rXHJcblxyXG5cdFx0Ly9sZXQgYWN0Y2FudmFzZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYWN0aXZlRmlsZSk7XHJcblx0XHRsZXQgY29udGVudCA9IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoYWN0aXZlRmlsZSk7XHJcblxyXG5cdFx0cmV0dXJuIGNvbnRlbnQ7XHJcblx0fVx0XHJcblxyXG5cclxuXHRhc3luYyB3cml0ZUMyRG9jKGNhbnZTdHJ1Y3QpIHtcclxuXHJcblx0XHRsZXQgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRsZXQgbWRGb2xkZXJQYXRoOiBzdHJpbmcgPSBwYXRoLmRpcm5hbWUoYWN0aXZlRmlsZS5wYXRoKTtcclxuXHJcblx0XHQvLyBUT0RPIGFsc28gZm9yIGxpbmtzLCBub3QganVzdCBlbWJlZGRpbmdzXHJcblx0XHRjb25zdCBwYXR0ZXJuID0gL1xcIVxcW1xcWyhbXltcXF1dKylcXF1cXF0vZztcclxuXHRcdGNvbnN0IG1hdGNoZXMgPSBjYW52U3RydWN0Lm1hdGNoKHBhdHRlcm4pO1xyXG5cclxuXHRcdGxldCBkb2Njb250ZW50c3RyaW5nID0gXCI+IFshc3VjY2Vzc10gVGhpcyBpcyB5b3VyIGNvbnZlcnRlZCBhbmQgY2xlYXJlZCBkb2N1bWVudCBmcm9tIENhbnZhczJEb2N1bWVudFxcblxcPiAoeW91IGNhbiBkZWxldGUgdGhpcyBpbmZvYm94KVxcblxcblwiXHJcblxyXG5cdFx0aWYgKCEgbWF0Y2hlcykge1xyXG5cdFx0XHRyZXR1cm5cclxuXHRcdH1cclxuXHJcblx0XHRsZXQgdGV4dGZpbGVuYW1lcyA9IFtdXHJcblx0XHRsZXQgZmlsZW5hbWVzID0gW11cclxuXHJcblx0XHRtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xyXG5cdFx0XHRsZXQgZW1iZWRkZWRmaWxlbmFtZSA9IG1hdGNoLnJlcGxhY2UoL1xcIVxcW1xcWyguKilcXF1cXF0vLCAnJDEnKTtcclxuXHJcblx0XHRcdGlmIChlbWJlZGRlZGZpbGVuYW1lLmVuZHNXaXRoKFwiLm1kXCIpKSB7XHJcblx0XHRcdFx0Ly8gaWYgZW1iZWRkZWRmaWxlbmFtZSBzdGFydHMgd2l0aCBcIi4vXCIgcmVtb3ZlIGl0XHJcblx0XHRcdFx0aWYgKGVtYmVkZGVkZmlsZW5hbWUuc3RhcnRzV2l0aChcIi4vXCIpKSB7XHJcblx0XHRcdFx0XHRlbWJlZGRlZGZpbGVuYW1lID0gZW1iZWRkZWRmaWxlbmFtZS5yZXBsYWNlKFwiLi9cIiwgXCJcIilcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGV4dGZpbGVuYW1lcy5wdXNoKGVtYmVkZGVkZmlsZW5hbWUpO1xyXG5cdFx0XHR9IFxyXG5cclxuXHRcdFx0ZmlsZW5hbWVzLnB1c2goZW1iZWRkZWRmaWxlbmFtZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zdCBmaWxlQ29udGVudHMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuXHRcdFx0dGV4dGZpbGVuYW1lcy5tYXAoXHJcblx0XHRcdCAgYXN5bmMgKGZpbGUpID0+IFtmaWxlLCBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlKSldIGFzIGNvbnN0LFxyXG5cdFx0XHQpLFxyXG5cdCAgICApO1xyXG5cclxuXHRcdGZvciAoY29uc3QgeGZpbGUgb2YgZmlsZW5hbWVzKSB7XHJcblx0XHRcdGlmICh4ZmlsZS5lbmRzV2l0aChcIi5tZFwiKSkge1xyXG5cdFx0XHRcdGNvbnN0IGZvdW5kID0gZmlsZUNvbnRlbnRzLmZpbmQoKGVsZW1lbnQpID0+IGVsZW1lbnRbMF0gPT0geGZpbGUpO1xyXG5cclxuXHRcdFx0XHRjb25zdCB7IGRpciwgbmFtZSwgZXh0IH0gPSBwYXRoLnBhcnNlKHhmaWxlKTtcclxuXHJcblx0XHRcdFx0aWYgKCEgZGlyLmVuZHNXaXRoKFwiX2NhbnZhczJkb2MtZGF0YVwiKSkge1xyXG5cdFx0XHRcdFx0ZG9jY29udGVudHN0cmluZyArPSBcIiMgXCIgKyBuYW1lICsgXCJcXG5cXG5cIlxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0ZG9jY29udGVudHN0cmluZyArPSBmb3VuZFsxXSArIFwiXFxuXFxuXCJcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRkb2Njb250ZW50c3RyaW5nICs9IFwiIVtbXCIgKyB4ZmlsZSArIFwiXV1cXG5cXG5cIlxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGRvY0ZpbGVuYW1lXHJcblx0XHRpZiAobWRGb2xkZXJQYXRoID09IFwiLlwiKSB7XHJcblx0ICAgIFx0ZG9jRmlsZW5hbWUgPSBhY3RpdmVGaWxlLmJhc2VuYW1lICsgXCJfXCIgKyBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpLzEwMDApICsgXCJfZnJvbUMyRC5tZFwiXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRkb2NGaWxlbmFtZSA9IG1kRm9sZGVyUGF0aCArIFwiL1wiICsgYWN0aXZlRmlsZS5iYXNlbmFtZSArIFwiX1wiICsgTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKS8xMDAwKSArIFwiX2Zyb21DMkQubWRcIlx0XHRcdFx0XHRcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZG9jRmlsZW5hbWUsIGRvY2NvbnRlbnRzdHJpbmcpXHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiZXJyb3Igd3JpdGluZyB0aGUgbmV3IGNsZWFyZSBkb2MgZmlsZSBcIiArIGUpXHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgZG9jZnRhYiA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkb2NGaWxlbmFtZSk7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0YXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3NwbGl0Jykub3BlbkZpbGUoZG9jZnRhYik7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKGUpXHJcblx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHR9XHJcblxyXG5cdGFzeW5jIHJlYWRDYW52YXNTdHJ1Y3QoKTogUHJvbWlzZTxudW1iZXI+IHtcclxuXHRcdC8qXHJcblx0XHRjaGVjayBvbiBhY3RpdmUgZmlsZSBpcyBjYW52YXNcclxuXHRcdCovXHJcblx0XHRsZXQgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRpZiAoIWFjdGl2ZUZpbGUgfHwgYWN0aXZlRmlsZS5leHRlbnNpb24gIT0gXCJjYW52YXNcIikge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRsZXQgbWRGb2xkZXJQYXRoOiBzdHJpbmcgPSBwYXRoLmRpcm5hbWUoYWN0aXZlRmlsZS5wYXRoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBUT0RPOiBwcmV2ZW50IHJlYWRpbmcgYWxsIGZpbGVzLCBqdXN0IHRoZSBhY3RpdmUgZmlsZSwgaWYgY2FudmFzIGNoZWNrIG9rXHJcblxyXG5cdFx0Ly9sZXQgYWN0Y2FudmFzZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYWN0aXZlRmlsZSk7XHJcblx0XHRsZXQgY29udGVudCA9IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoYWN0aXZlRmlsZSk7XHJcblxyXG5cdFx0cmV0dXJuIGNvbnRlbnQ7XHJcblx0fVx0XHJcblxyXG5cdC8vIFRPRE8gZGllc2Ugd2lyZCBkaWUgZmluZERlZmluZWRDaGlsZHJlbiwgbmljaHQgcmVrdXJzaXZlciBjYWxsLCBzb25kZXJuIDItMyBtYWwgLT4gNSBNYWwgbGlrZSBoZWFkaW5nc1xyXG5cdC8vIGRhbm4gZGVyIFJlc3QgXHUwMEZDYmVyIGZpbmRBbGxYQ2hyaWxkcmVuIHdpcmQgZGFubiBkZXIgbGV0enRlbiBFYmVuZSBub2NoIHp1Z2VvcmRuZXRcclxuXHJcblx0YXN5bmMgZmluZEFsbFhDaGlsZHJlbihzdGFydEdlbmVyYXRpb24sIG15cGFyc2VkX2RhdGEsIGZpbGVDb250ZW50cywgaGFuZGxlZE5vZGVzLCBsaW1pdHJlY3Vyc2VOb2RlcywgcnVuY291bnRlcmZ1bmMsIHJ1bmNvdW50ZXJmb3JlYWNoKTpQcm9taXNlPGJvb2xlYW4+IHtcclxuXHJcblx0XHRydW5jb3VudGVyZnVuYysrXHJcblx0XHRpZiAocnVuY291bnRlcmZ1bmMgPiAzMCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2VcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGNvbnN0IGNoaWxkIG9mIHN0YXJ0R2VuZXJhdGlvbikge1xyXG5cdFx0XHRydW5jb3VudGVyZm9yZWFjaCsrXHJcblx0XHRcdGlmIChydW5jb3VudGVyZm9yZWFjaCA+IG15cGFyc2VkX2RhdGEuZWRnZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGNvbnN0IG5vZGVlbnRyeSA9IG15cGFyc2VkX2RhdGEubm9kZXMuZmluZChlbnRyeSA9PiBlbnRyeS5pZCA9PT0gY2hpbGQpO1xyXG5cdFxyXG5cdFx0XHRpZiAoISBoYW5kbGVkTm9kZXMuaGFzKGNoaWxkKSkge1xyXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZm9ybWF0Tm9kZShub2RlZW50cnksIDYpXHJcblx0XHRcdFx0ZmlsZUNvbnRlbnRzLnB1c2gocmVzdWx0KTtcclxuXHRcdFx0XHRoYW5kbGVkTm9kZXMuYWRkKGNoaWxkKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRsaW1pdHJlY3Vyc2VOb2RlcysrXHJcblxyXG5cdFx0XHRcdGlmIChsaW1pdHJlY3Vyc2VOb2RlcyA+IDMwKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2VcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCBjaGlsZHJlbiA9IG15cGFyc2VkX2RhdGEuZWRnZXMuZmlsdGVyKGVkZ2UgPT4gZWRnZS5mcm9tTm9kZSA9PT0gY2hpbGQpLm1hcChlZGdlID0+IGVkZ2UudG9Ob2RlKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChjaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0Y29uc3QgY29udGludWVSZWN1cnNpb24gPSBhd2FpdCB0aGlzLmZpbmRBbGxYQ2hpbGRyZW4oY2hpbGRyZW4sIG15cGFyc2VkX2RhdGEsIGZpbGVDb250ZW50cywgaGFuZGxlZE5vZGVzLCBsaW1pdHJlY3Vyc2VOb2RlcywgcnVuY291bnRlcmZ1bmMsIHJ1bmNvdW50ZXJmb3JlYWNoKTtcclxuXHRcdFx0XHRpZiAoIWNvbnRpbnVlUmVjdXJzaW9uKSByZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0bGltaXRyZWN1cnNlTm9kZXMrK1xyXG5cdFx0cmV0dXJuIGxpbWl0cmVjdXJzZU5vZGVzIDw9IDMwXHJcblx0fVxyXG5cclxuXHRcclxuXHRhc3luYyB0cmF2ZXJzZU5vZGVzKGluaXRpYWxOb2RlcywgbXlwYXJzZWRfZGF0YSwgZmlsZUNvbnRlbnRzLCBoYW5kbGVkTm9kZXMpIHtcclxuXHJcblx0XHRmb3IgKGNvbnN0IG5vZGUgb2YgaW5pdGlhbE5vZGVzKSB7XHJcblxyXG5cdFx0XHRjb25zdCBub2RlZW50cnkgPSBteXBhcnNlZF9kYXRhLm5vZGVzLmZpbmQoZW50cnkgPT4gZW50cnkuaWQgPT09IG5vZGUpO1xyXG5cclxuXHRcdFx0Ly8gaXMgIHNraXBoYW5kbGVkTm9kZXMgaXMgdHJ1ZSwgY2hlY2sgaWYgbm9kZSBpcyBhbHJlYWR5IGhhbmRsZWRcclxuXHRcdFx0aWYgKCEgaGFuZGxlZE5vZGVzLmhhcyhub2RlKSkge1xyXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZm9ybWF0Tm9kZShub2RlZW50cnksIDEpO1xyXG5cdFx0XHRcdGZpbGVDb250ZW50cy5wdXNoKHJlc3VsdCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGhhbmRsZWROb2Rlcy5hZGQobm9kZSk7XHJcblxyXG5cdFx0XHRjb25zdCBjaGlsZHJlbjEgPSBteXBhcnNlZF9kYXRhLmVkZ2VzXHJcblx0XHRcdC5maWx0ZXIoZWRnZSA9PiBlZGdlLmZyb21Ob2RlID09PSBub2RlKVxyXG5cdFx0XHQubWFwKGVkZ2UgPT4gZWRnZS50b05vZGUpO1xyXG5cdFxyXG5cdFx0XHRmb3IgKGNvbnN0IGNoaWxkMSBvZiBjaGlsZHJlbjEpIHtcclxuXHRcdFxyXG5cdFx0XHRcdGNvbnN0IG5vZGVlbnRyeSA9IG15cGFyc2VkX2RhdGEubm9kZXMuZmluZChlbnRyeSA9PiBlbnRyeS5pZCA9PT0gY2hpbGQxKTtcclxuXHJcblx0XHRcdFx0aWYgKCEgaGFuZGxlZE5vZGVzLmhhcyhjaGlsZDEpKSB7XHJcblx0XHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmZvcm1hdE5vZGUobm9kZWVudHJ5LCAyKTtcclxuXHRcdFx0XHRcdGZpbGVDb250ZW50cy5wdXNoKHJlc3VsdCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRoYW5kbGVkTm9kZXMuYWRkKGNoaWxkMSk7XHJcblx0XHJcblx0XHRcdFx0Y29uc3QgY2hpbGRyZW4yID0gbXlwYXJzZWRfZGF0YS5lZGdlc1xyXG5cdFx0XHRcdC5maWx0ZXIoZWRnZSA9PiBlZGdlLmZyb21Ob2RlID09PSBjaGlsZDEpXHJcblx0XHRcdFx0Lm1hcChlZGdlID0+IGVkZ2UudG9Ob2RlKTtcclxuXHRcdFxyXG5cdFx0XHRcdGZvciAoY29uc3QgY2hpbGQyIG9mIGNoaWxkcmVuMikge1xyXG5cclxuXHRcdFx0XHRcdGNvbnN0IG5vZGVlbnRyeSA9IG15cGFyc2VkX2RhdGEubm9kZXMuZmluZChlbnRyeSA9PiBlbnRyeS5pZCA9PT0gY2hpbGQyKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoISBoYW5kbGVkTm9kZXMuaGFzKGNoaWxkMikpIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5mb3JtYXROb2RlKG5vZGVlbnRyeSwgMyk7XHJcblx0XHRcdFx0XHRcdGZpbGVDb250ZW50cy5wdXNoKHJlc3VsdCk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0aGFuZGxlZE5vZGVzLmFkZChjaGlsZDIpO1xyXG5cclxuXHRcdFx0XHRcdGNvbnN0IGNoaWxkcmVuMyA9IG15cGFyc2VkX2RhdGEuZWRnZXNcclxuXHRcdFx0XHRcdC5maWx0ZXIoZWRnZSA9PiBlZGdlLmZyb21Ob2RlID09PSBjaGlsZDIpXHJcblx0XHRcdFx0XHQubWFwKGVkZ2UgPT4gZWRnZS50b05vZGUpO1xyXG5cdFx0XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0XHRmb3IgKGNvbnN0IGNoaWxkMyBvZiBjaGlsZHJlbjMpIHtcclxuXHRcdFxyXG5cdFx0XHRcdFx0XHRjb25zdCBub2RlZW50cnkgPSBteXBhcnNlZF9kYXRhLm5vZGVzLmZpbmQoZW50cnkgPT4gZW50cnkuaWQgPT09IGNoaWxkMyk7XHJcblxyXG5cdFx0XHRcdFx0XHRpZiAoISBoYW5kbGVkTm9kZXMuaGFzKGNoaWxkMykpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmZvcm1hdE5vZGUobm9kZWVudHJ5LCA0KTtcclxuXHRcdFx0XHRcdFx0XHRmaWxlQ29udGVudHMucHVzaChyZXN1bHQpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRoYW5kbGVkTm9kZXMuYWRkKGNoaWxkMyk7XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBjaGlsZHJlbjQgPSBteXBhcnNlZF9kYXRhLmVkZ2VzXHJcblx0XHRcdFx0XHRcdC5maWx0ZXIoZWRnZSA9PiBlZGdlLmZyb21Ob2RlID09PSBjaGlsZDMpXHJcblx0XHRcdFx0XHRcdC5tYXAoZWRnZSA9PiBlZGdlLnRvTm9kZSk7XHJcblx0XHRcclxuXHRcdFx0XHRcdFx0Zm9yIChjb25zdCBjaGlsZDQgb2YgY2hpbGRyZW40KSB7XHJcblx0XHRcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBub2RlZW50cnkgPSBteXBhcnNlZF9kYXRhLm5vZGVzLmZpbmQoZW50cnkgPT4gZW50cnkuaWQgPT09IGNoaWxkNCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmICghIGhhbmRsZWROb2Rlcy5oYXMoY2hpbGQ0KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5mb3JtYXROb2RlKG5vZGVlbnRyeSwgNSk7XHJcblx0XHRcdFx0XHRcdFx0XHRmaWxlQ29udGVudHMucHVzaChyZXN1bHQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0aGFuZGxlZE5vZGVzLmFkZChjaGlsZDQpO1xyXG5cdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjaGlsZHJlbjUgPSBteXBhcnNlZF9kYXRhLmVkZ2VzXHJcblx0XHRcdFx0XHRcdFx0LmZpbHRlcihlZGdlID0+IGVkZ2UuZnJvbU5vZGUgPT09IGNoaWxkNClcclxuXHRcdFx0XHRcdFx0XHQubWFwKGVkZ2UgPT4gZWRnZS50b05vZGUpO1xyXG5cdFx0XHJcblxyXG5cdFx0XHRcdFx0XHRcdGZvciAoY29uc3QgY2hpbGQ1IG9mIGNoaWxkcmVuNSkge1xyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3Qgbm9kZWVudHJ5ID0gbXlwYXJzZWRfZGF0YS5ub2Rlcy5maW5kKGVudHJ5ID0+IGVudHJ5LmlkID09PSBjaGlsZDUpO1xyXG5cdFxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCEgaGFuZGxlZE5vZGVzLmhhcyhjaGlsZDUpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZm9ybWF0Tm9kZShub2RlZW50cnksIDYpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRmaWxlQ29udGVudHMucHVzaChyZXN1bHQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGhhbmRsZWROb2Rlcy5hZGQoY2hpbGQ1KTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNoaWxkcmVuNiA9IG15cGFyc2VkX2RhdGEuZWRnZXMuZmlsdGVyKGVkZ2UgPT4gZWRnZS5mcm9tTm9kZSA9PT0gY2hpbGQ1KS5tYXAoZWRnZSA9PiBlZGdlLnRvTm9kZSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gbm93IHR1cm4gdG8gaW5maW5pdHkgLT4gZmluZEFsbFhDaGlsZHJlbigpXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGxldCBydW5jb3VudGVyZnVuYzogbnVtYmVyID0gMFxyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IHJ1bmNvdW50ZXJmb3JlYWNoOiBudW1iZXIgPSAwXHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgbGltaXRyZWN1cnNlTm9kZXM6IG51bWJlciA9IDBcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmZpbmRBbGxYQ2hpbGRyZW4oY2hpbGRyZW42LCBteXBhcnNlZF9kYXRhLCBmaWxlQ29udGVudHMsIGhhbmRsZWROb2RlcywgbGltaXRyZWN1cnNlTm9kZXMsIHJ1bmNvdW50ZXJmdW5jLCBydW5jb3VudGVyZm9yZWFjaCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyByZWFkQ2FudmFzRGF0YShzdHJ1Y3QpIHtcclxuXHRcdC8vIFRPRE86IG5vY2htYWwgbmFjaCBodHRwczovL2RvY3Mub2JzaWRpYW4ubWQvUGx1Z2lucy9WYXVsdCwgcmVhZCBhbGwgZmlsZXNcclxuXHRcdC8vIGlucHV0IGxpc3RlIGViZW4gYXVzIGNhbnZhcy1KU09OIGFsbGUgbm9kZXNcclxuXHJcblx0XHRjb25zdCBmaWxlQ29udGVudHM6IFtzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBudW1iZXIsIHN0cmluZywgc3RyaW5nXVtdID0gW107XHJcblxyXG5cdFx0bGV0ICBteXBhcnNlZF9kYXRhID0gSlNPTi5wYXJzZShzdHJ1Y3QpO1xyXG5cclxuXHRcdGNvbnN0IHNpbmdsZU5vZGVJRHMgPSBuZXcgU2V0KCk7XHJcblx0XHRjb25zdCBncm91cE5vZGVzID0gbmV3IFNldCgpO1xyXG5cclxuXHRcdG15cGFyc2VkX2RhdGEubm9kZXMuZm9yRWFjaChub2RlID0+IHtcclxuXHRcdFx0aWYgKG5vZGUudHlwZSA9PT0gXCJncm91cFwiKSB7XHJcblx0XHRcdFx0Ly8gVE9ETyBsYXRlciB3ZSBhbHNvIGhhbmRsZSBncm91cHNcclxuXHRcdFx0XHRncm91cE5vZGVzLmFkZChub2RlLmlkKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzaW5nbGVOb2RlSURzLmFkZChub2RlLmlkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gRXh0cmFjdCB1bmlxdWUgZnJvbU5vZGVzIGFuZCB0b05vZGVzXHJcblx0XHRjb25zdCBmcm9tTm9kZXMgPSBuZXcgU2V0KCk7XHJcblx0XHRjb25zdCB0b05vZGVzID0gbmV3IFNldCgpO1xyXG5cdFx0bXlwYXJzZWRfZGF0YS5lZGdlcy5mb3JFYWNoKGVkZ2UgPT4ge1xyXG5cclxuXHRcdFx0Ly8gVE9ETyBsYXRlciB3ZSBhbHNvIGhhbmRsZSBncm91cHNcclxuXHRcdFx0aWYgKGdyb3VwTm9kZXMuaGFzKGVkZ2UuZnJvbU5vZGUpIHx8IGdyb3VwTm9kZXMuaGFzKGVkZ2UudG9Ob2RlKSkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0ZnJvbU5vZGVzLmFkZChlZGdlLmZyb21Ob2RlKTtcclxuXHRcdFx0dG9Ob2Rlcy5hZGQoZWRnZS50b05vZGUpO1xyXG5cdFx0fSk7XHJcblxyXG5cclxuXHRcdGxldCBoYW5kbGVkTm9kZXMgPSBuZXcgU2V0KCk7XHJcblx0XHQvLyBUT0RPIG1ha2UgdGhpcyBhIHNldHRpbmdcclxuXHRcdGNvbnN0IHNraXBoYW5kbGVkTm9kZXMgPSB0cnVlXHJcblxyXG5cdFx0bGV0IG5vZGVzV2l0aG91dFBhcmVudHMgPSBbLi4uc2luZ2xlTm9kZUlEc10uZmlsdGVyKG5vZGUgPT4gIXRvTm9kZXMuaGFzKG5vZGUpKTtcclxuXHJcblx0XHRpZiAobm9kZXNXaXRob3V0UGFyZW50cy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0bm9kZXNXaXRob3V0UGFyZW50cyA9IFsuLi5zaW5nbGVOb2RlSURzXTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBmaXJzdCByb3VuZCBvZiBub2RlcyB3aXRob3V0IHBhcmVudHNcclxuXHRcdGNvbnN0IHRyYXZlcnNlcmVzdWx0ID0gYXdhaXQgdGhpcy50cmF2ZXJzZU5vZGVzKG5vZGVzV2l0aG91dFBhcmVudHMsIG15cGFyc2VkX2RhdGEsIGZpbGVDb250ZW50cywgaGFuZGxlZE5vZGVzKTtcclxuXHJcblx0XHRjb25zdCBkaWZmID0gbmV3IFNldChbLi4uc2luZ2xlTm9kZUlEc10uZmlsdGVyKHggPT4gIWhhbmRsZWROb2Rlcy5oYXMoeCkpKTtcclxuXHRcdFxyXG5cdFx0Ly8gaWYgZGlmZiBpcyBub3QgZW1wdHksIHdlIGhhdmUgbm9kZXMgd2l0aG91dCBwYXJlbnRzIGFuZCBnaXZlIHRoZW0gdG8gZmluZEFsbFhDaGlsZHJlbiBhZ2FpblxyXG5cdFx0aWYgKGRpZmYuc2l6ZSA+IDApIHtcclxuXHRcdFx0Y29uc3QgdHJhdmVyc2VyZXN1bHQgPSBhd2FpdCB0aGlzLnRyYXZlcnNlTm9kZXMoZGlmZiwgbXlwYXJzZWRfZGF0YSwgZmlsZUNvbnRlbnRzLCBoYW5kbGVkTm9kZXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmaWxlQ29udGVudHM7XHRcdFxyXG5cdH1cclxuXHJcblx0YXN5bmMgZm9ybWF0Tm9kZShub2RlLCBsZXZlbCk6IFByb21pc2U8W3N0cmluZywgc3RyaW5nLCBzdHJpbmcsIG51bWJlciwgc3RyaW5nLCBzdHJpbmddPiB7XHJcblx0XHRjb25zdCBpZCA9IG5vZGUuaWQ7XHJcblx0XHRjb25zdCB0eXBlID0gbm9kZS50eXBlO1xyXG5cdFx0bGV0IG5vZGVmaWxlID0gXCJcIjtcclxuXHJcblx0XHRpZiAodHlwZSA9PT0gXCJmaWxlXCIpIHtcclxuXHRcdFx0bm9kZWZpbGUgPSBub2RlLmZpbGU7XHJcblxyXG5cdFx0XHRjb25zdCB7IG5hbWUsIGV4dCB9ID0gcGF0aC5wYXJzZShub2RlZmlsZSk7XHJcblxyXG5cdFx0XHRpZiAoZXh0ID09PSBcIi5tZFwiKSB7XHJcblx0XHRcdFx0cmV0dXJuIFtpZCwgdHlwZSwgbm9kZWZpbGUsIGxldmVsLCBcInRleHRmaWxlXCIsIG5hbWVdO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGV4dCA9PT0gXCIuanBnXCIgfHwgZXh0ID09IFwiLmpwZWdcIiB8fCBleHQgPT09IFwiLnBuZ1wiIHx8IGV4dCA9PT0gXCIuZ2lmXCIpIHtcclxuXHRcdFx0XHRyZXR1cm4gW2lkLCB0eXBlLCBub2RlZmlsZSwgbGV2ZWwsIFwiY29udGVudGltYWdlXCIsIG5hbWUgKyBcIi5cIiArIGV4dF07XHJcblx0XHRcdH0gZWxzZSBpZiAoZXh0ID09PSBcIi5wZGZcIikge1xyXG5cdFx0XHRcdHJldHVybiBbaWQsIHR5cGUsIG5vZGVmaWxlLCBsZXZlbCwgXCJjb250ZW50cGRmXCIsIG5hbWUgKyBcIi5cIiArIGV4dF07XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly9UT0RPIGhhbmRsZSB1bmtub3duIGZpbGUgdHlwZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh0eXBlID09PSBcImxpbmtcIikge1xyXG5cdFx0XHRpZiAobm9kZS51cmwuaW5jbHVkZXMoXCJ5b3V0dWJlXCIpKSB7XHJcblx0XHRcdFx0Y29uc3QgdXJsID0gbm9kZS51cmw7XHJcblx0XHRcdFx0cmV0dXJuIFtpZCwgdHlwZSwgdXJsLCBsZXZlbCwgXCJjb250ZW50eW91dHViZVwiLCBub2RlLnVybF07XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmV0dXJuIFtpZCwgdHlwZSwgbm9kZS51cmwsIGxldmVsLCBcImNvbnRlbnRsaW5rXCIsIG5vZGUudXJsXTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh0eXBlID09PSBcInRleHRcIikge1xyXG5cdFx0XHRjb25zdCB0ZXh0ID0gbm9kZS50ZXh0O1xyXG5cdFx0XHQvLyBnZXQgZmlyc3QgMTAwIGNoYXJzIG9mIHRleHRcclxuXHRcdFx0Y29uc3QgdGV4dFByZXZpZXcgPSB0ZXh0LnN1YnN0cmluZygwLCAxMDApO1xyXG5cclxuXHRcdFx0cmV0dXJuIFtpZCwgdHlwZSwgXCJub2RlXCIsIGxldmVsLCB0ZXh0LCB0ZXh0UHJldmlld107XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGFzeW5jIHdyaXRlQ2FudkRvY0ZpbGUoY29udGVudCwgY29udlN0cnVjdCkge1xyXG5cdFx0Ly8gZXN0YWJsaXNoaW5nIHRoZSB3b3JrZGlyXHJcblx0XHRsZXQgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRsZXQgbWRGb2xkZXJQYXRoOiBzdHJpbmcgPSBwYXRoLmRpcm5hbWUoYWN0aXZlRmlsZS5wYXRoKTtcclxuXHJcblx0XHRsZXQgd3JpdGV3b3JrZGlyID0gbWRGb2xkZXJQYXRoICsgXCIvXCIgKyBhY3RpdmVGaWxlLmJhc2VuYW1lICsgXCJfY2FudmFzMmRvYy1kYXRhXCJcclxuXHRcdHRoaXMuZnNhZGFwdGVyLm1rZGlyKHdyaXRld29ya2RpcilcclxuXHJcblx0XHRsZXQgY2FudmFzRmlsZVxyXG5cdFx0bGV0IGNhbnZhc0ZpbGVuYW1lXHJcblx0XHRpZiAobWRGb2xkZXJQYXRoID09IFwiLlwiKSB7XHJcblx0ICAgIFx0Y2FudmFzRmlsZW5hbWUgPSBhY3RpdmVGaWxlLmJhc2VuYW1lICsgXCJfXCIgKyBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpLzEwMDApICsgXCJfZnJvbUNhbnZhcy5tZFwiXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjYW52YXNGaWxlbmFtZSA9IG1kRm9sZGVyUGF0aCArIFwiL1wiICsgYWN0aXZlRmlsZS5iYXNlbmFtZSArIFwiX1wiICsgTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKS8xMDAwKSArIFwiX2Zyb21DYW52YXMubWRcIlx0XHRcdFx0XHRcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgY29udGVudFN0cmluZyA9IFwiPiBbIWluZm9dIFRoaXMgaXMgYW4gYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgZG9jdW1lbnQgZnJvbSBQbHVnaW4gW0NhbnZhczJEb2N1bWVudF0oaHR0cHM6Ly9naXRodWIuY29tL3NsbnN5cy9vYnNpZGlhbi1jYW52YXMyZG9jdW1lbnQpXFxuXFw+IGFycmFuZ2UgdGhlIGRvY3VtZW50IGFzIHlvdSBuZWVkIHdpdGggdGhlIG91dGxpbmUsIHRoZW4gY2FsbCAqQ2xlYXIgY2FudmFzMmRvY3VtZW50IHRhcmdldCBkb2N1bWVudCpcXG5cXG5cIlxyXG5cclxuXHRcdGxldCBteXBhcnNlZF9kYXRhID0gSlNPTi5wYXJzZShjb252U3RydWN0KTtcclxuXHJcblx0XHRmb3IgKGNvbnN0IGVsZW1lbnQgb2YgY29udGVudCkge1xyXG5cdFx0XHRcclxuXHRcdFx0bGV0IGNuZm5hbWUgPSBcIlwiXHJcblxyXG5cdFx0XHQvLyBwbGFjZSBudW1iZXIgb2YgIyBhY2NvcmRpbmcgdG8gbGV2ZWxcclxuXHRcdFx0bGV0IGhlYWRpbmcgPSBcIlwiXHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRbM107IGkrKykge1xyXG5cdFx0XHRcdGhlYWRpbmcgKz0gXCIjXCJcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGVsZW1lbnRbMV0gPT0gXCJ0ZXh0XCIpIHtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRjbmZuYW1lID0gd3JpdGV3b3JrZGlyICsgXCIvXCIgKyBcIm5ld2RvYy1ub2RlX1wiICsgZWxlbWVudFswXSArIFwiX2Zyb21DYW52YXMubWRcIlxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCJcXG5cXG5cIiArIGhlYWRpbmcgKyBcIiBfY2FyZCBcIiArIGVsZW1lbnRbNV0gKyBcIlxcblwiXHJcblx0XHRcdFx0Y29udGVudFN0cmluZyArPSBlbGVtZW50WzJdICsgXCIgXlwiICsgZWxlbWVudFswXSArIFwiXFxuXFxuXCJcclxuXHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiPiBbIXRpcF0gbGluayBuYXZpZ2F0aW9uIGZyb20gdGhlIGNhbnZhc1xcblwiXHJcblxyXG5cdFx0XHRcdGZvciAoY29uc3QgZWRnZSBvZiBteXBhcnNlZF9kYXRhLmVkZ2VzKSB7XHJcblx0XHRcdFx0XHRpZiAoZWRnZS5mcm9tTm9kZSA9PSBlbGVtZW50WzBdKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kID0gY29udGVudC5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50WzBdID09IGVkZ2UudG9Ob2RlKTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZmlyc3RsaW5lID0gZm91bmRbNV0uc3BsaXQoJ1xcbicpWzBdXHJcblx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kNSA9IGZpcnN0bGluZS5yZXBsYWNlKC8jL2csIFwiXCIpXHJcblxyXG5cdFx0XHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiPiBsaW5raW5nIHRvOiBbWyNeXCIgKyBlZGdlLnRvTm9kZSArIFwifFwiICsgZm91bmQ1ICsgXCJdXVxcblwiXHJcblx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdFx0aWYgKGVkZ2UudG9Ob2RlID09IGVsZW1lbnRbMF0pIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZm91bmQgPSBjb250ZW50LmZpbmQoKGVsZW1lbnQpID0+IGVsZW1lbnRbMF0gPT0gZWRnZS5mcm9tTm9kZSk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZpcnN0bGluZSA9IGZvdW5kWzVdLnNwbGl0KCdcXG4nKVswXVxyXG5cdFx0XHRcdFx0XHRjb25zdCBmb3VuZDUgPSBmaXJzdGxpbmUucmVwbGFjZSgvIy9nLCBcIlwiKVxyXG5cclxuXHRcdFx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIj4gbGlua2VkIGZyb206IFtbI15cIiArIGVkZ2UuZnJvbU5vZGUgKyBcInxcIiArIGZvdW5kNSArIFwiXV1cXG5cIlxyXG5cdFx0XHRcdFx0fSBcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vRW1iZWRkaW5nXHJcblx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIlxcbiAhW1tcIiArIGNuZm5hbWUgKyBcIl1dXFxuXFxuXCJcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoZWxlbWVudFsxXSA9PSBcImxpbmtcIikge1xyXG5cdFx0XHRcdC8vIGNuZm5hbWUgPSB3cml0ZXdvcmtkaXIgKyBcIi9cIiArIFwibmV3ZG9jLW5vZGVfXCIgKyBlbGVtZW50WzBdICsgXCIgX2Zyb21DYW52YXMubWRcIlxyXG5cclxuXHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiXFxuXFxuXCIgKyBoZWFkaW5nICsgXCIgX2xpbmsgXCIgKyBlbGVtZW50WzVdICsgXCJcXG5cIlxyXG5cdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gZWxlbWVudFsyXSArIFwiIF5cIiArIGVsZW1lbnRbMF0gKyBcIlxcblxcblwiXHJcblx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIj4gWyF0aXBdIGxpbmsgbmF2aWdhdGlvbiBmcm9tIHRoZSBjYW52YXNcXG5cIlxyXG5cclxuXHRcdFx0XHRmb3IgKGNvbnN0IGVkZ2Ugb2YgbXlwYXJzZWRfZGF0YS5lZGdlcykge1xyXG5cdFx0XHRcdFx0aWYgKGVkZ2UuZnJvbU5vZGUgPT0gZWxlbWVudFswXSkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBmb3VuZCA9IGNvbnRlbnQuZmluZCgoZWxlbWVudCkgPT4gZWxlbWVudFswXSA9PSBlZGdlLnRvTm9kZSk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZpcnN0bGluZSA9IGZvdW5kWzVdLnNwbGl0KCdcXG4nKVswXVxyXG5cdFx0XHRcdFx0XHRjb25zdCBmb3VuZDUgPSBmaXJzdGxpbmUucmVwbGFjZSgvIy9nLCBcIlwiKVxyXG5cclxuXHRcdFx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIj4gbGlua2luZyB0bzogW1sjXlwiICsgZWRnZS50b05vZGUgKyBcInxcIiArIGZvdW5kNSArIFwiXV1cXG5cIlxyXG5cdFx0XHRcdFx0fSBcclxuXHRcdFx0XHRcdGlmIChlZGdlLnRvTm9kZSA9PSBlbGVtZW50WzBdKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kID0gY29udGVudC5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50WzBdID09IGVkZ2UuZnJvbU5vZGUpO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBmaXJzdGxpbmUgPSBmb3VuZFs1XS5zcGxpdCgnXFxuJylbMF1cclxuXHRcdFx0XHRcdFx0Y29uc3QgZm91bmQ1ID0gZmlyc3RsaW5lLnJlcGxhY2UoLyMvZywgXCJcIilcclxuXHJcblx0XHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCI+IGxpbmtlZCBmcm9tOiBbWyNeXCIgKyBlZGdlLmZyb21Ob2RlICsgXCJ8XCIgKyBmb3VuZDUgKyBcIl1dXFxuXCJcclxuXHRcdFx0XHRcdH0gXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL0VtYmVkZGluZyBtZWRpYSBzcGVjaWZpY1xyXG5cdFx0XHRcdC8vIFRPRE8gYWxzbyBhZGQgbmF2aWdhdGlvbmFsIHRpdGxlIGRhdGEgdG8gZWxlbWVudCBtZXRhYm94XHJcblx0XHRcdFx0aWYgKGVsZW1lbnRbNF0gPT0gXCJjb250ZW50eW91dHViZVwiKSB7XHJcblx0XHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiXFxuICFbXShcIiArIGVsZW1lbnRbMl0gKyBcIilcXG5cXG5cIlxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoZWxlbWVudFs0XSA9PSBcImNvbnRlbnRsaW5rXCIpIHtcclxuXHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCJcXG4gPGlmcmFtZSBzcmM9XFxcIlwiICsgZWxlbWVudFsyXSArIFwiXFxcIj48L2lmcmFtZT5cXG5cXG5cIlxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoZWxlbWVudFsxXSA9PSBcImZpbGVcIikge1xyXG5cdFx0XHRcdGlmIChlbGVtZW50WzRdID09IFwiY29udGVudGltYWdlXCIgfHwgZWxlbWVudFs0XSA9PSBcImNvbnRlbnRwZGZcIikge1xyXG5cclxuXHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCJcXG5cXG5cIiArIGhlYWRpbmcgKyBcIiBfTWVkaWEgXCIgKyBlbGVtZW50WzVdICsgXCJcXG5cIlxyXG5cdFx0XHRcdFx0Y29udGVudFN0cmluZyArPSBlbGVtZW50WzJdICsgXCIgXlwiICsgZWxlbWVudFswXSArIFwiXFxuXFxuXCJcclxuXHRcdFx0XHRcdC8vIFRPRE8gbGlua2luZyBib3ggbm9jaCBpbiBmdW5rdGlvbiBhdXNsYWdlcm5cclxuXHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCI+IFshdGlwXSBsaW5rIG5hdmlnYXRpb24gZnJvbSB0aGUgY2FudmFzXFxuXCJcclxuXHJcblx0XHRcdFx0XHRmb3IgKGNvbnN0IGVkZ2Ugb2YgbXlwYXJzZWRfZGF0YS5lZGdlcykge1xyXG5cdFx0XHRcdFx0XHRpZiAoZWRnZS5mcm9tTm9kZSA9PSBlbGVtZW50WzBdKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgZm91bmQgPSBjb250ZW50LmZpbmQoKGVsZW1lbnQpID0+IGVsZW1lbnRbMF0gPT0gZWRnZS50b05vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZpcnN0bGluZSA9IGZvdW5kWzVdLnNwbGl0KCdcXG4nKVswXVxyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kNSA9IGZpcnN0bGluZS5yZXBsYWNlKC8jL2csIFwiXCIpXHJcblxyXG5cdFx0XHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCI+IGxpbmtpbmcgdG86IFtbI15cIiArIGVkZ2UudG9Ob2RlICsgXCJ8XCIgKyBmb3VuZDUgKyBcIl1dXFxuXCJcclxuXHRcdFx0XHRcdFx0fSBcclxuXHRcdFx0XHRcdFx0aWYgKGVkZ2UudG9Ob2RlID09IGVsZW1lbnRbMF0pIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBmb3VuZCA9IGNvbnRlbnQuZmluZCgoZWxlbWVudCkgPT4gZWxlbWVudFswXSA9PSBlZGdlLmZyb21Ob2RlKTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBmaXJzdGxpbmUgPSBmb3VuZFs1XS5zcGxpdCgnXFxuJylbMF1cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBmb3VuZDUgPSBmaXJzdGxpbmUucmVwbGFjZSgvIy9nLCBcIlwiKVx0XHJcblxyXG5cdFx0XHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCI+IGxpbmtlZCBmcm9tOiBbWyNeXCIgKyBlZGdlLmZyb21Ob2RlICsgXCJ8XCIgKyBmb3VuZDUgKyBcIl1dXFxuXCJcclxuXHRcdFx0XHRcdFx0fSBcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIHN0YXJ0dGFnIG1ldGEgZGF0YSBibG9ja1xyXG5cdFx0XHRcdFx0Ly8gY29udGVudFN0cmluZyArPSBcIlxcbiUlXFxuY2FudmFzMmRvY3VtZW50IHBsdWdpbiBtZXRhZGF0YSBoZWFkZXIgZW5kXFxuJSVcXG5cIlxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly9FbWJlZGRpbmcgbWVkaWEgc3BlY2lmaWNcclxuXHRcdFx0XHRcdGlmIChlbGVtZW50WzRdID09IFwiY29udGVudHBkZlwiKSB7XHJcblx0XHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCJcXG4gIVtbXCIgKyBlbGVtZW50WzJdICsgXCIjaGVpZ2h0PTUwMF1dXFxuXFxuXCJcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoZWxlbWVudFs0XSA9PSBcImNvbnRlbnRpbWFnZVwiKSB7XHJcblx0XHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCJcXG4gIVtbXCIgKyBlbGVtZW50WzJdICsgXCJ8NTAwXV1cXG5cXG5cIlxyXG5cdFx0XHRcdFx0fVx0XHRcdFx0XHJcblxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBUT0RPIGNvbmZpcm0sIHRoYXQgZmlsZSBpcyBtZCwgbm90IHRoZSBlbHNlIGNhc2VcclxuXHJcblx0XHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiXFxuXFxuXCIgKyBoZWFkaW5nICsgXCIgX25vdGVGaWxlIFwiICsgZWxlbWVudFs1XSArIFwiXFxuXCJcclxuXHRcdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gZWxlbWVudFsyXSArIFwiIF5cIiArIGVsZW1lbnRbMF0gKyBcIlxcblxcblwiXHJcblx0XHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiPiBbIXRpcF0gbGluayBuYXZpZ2F0aW9uIGZyb20gdGhlIGNhbnZhc1xcblwiXHJcblxyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBlZGdlIG9mIG15cGFyc2VkX2RhdGEuZWRnZXMpIHtcclxuXHJcblx0XHRcdFx0XHRcdGlmIChlZGdlLmZyb21Ob2RlID09IGVsZW1lbnRbMF0pIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBmb3VuZCA9IGNvbnRlbnQuZmluZCgoZWxlbWVudCkgPT4gZWxlbWVudFswXSA9PSBlZGdlLnRvTm9kZSk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgZmlyc3RsaW5lID0gZm91bmRbNV0uc3BsaXQoJ1xcbicpWzBdXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgZm91bmQ1ID0gZmlyc3RsaW5lLnJlcGxhY2UoLyMvZywgXCJcIilcclxuXHJcblx0XHRcdFx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIj4gbGlua2luZyB0bzogW1sjXlwiICsgZWRnZS50b05vZGUgKyBcInxcIiArIGZvdW5kNSArIFwiXV1cXG5cIlxyXG5cdFx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdFx0XHRpZiAoZWRnZS50b05vZGUgPT0gZWxlbWVudFswXSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kID0gY29udGVudC5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50WzBdID09IGVkZ2UuZnJvbU5vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZpcnN0bGluZSA9IGZvdW5kWzVdLnNwbGl0KCdcXG4nKVswXVxyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZvdW5kNSA9IGZpcnN0bGluZS5yZXBsYWNlKC8jL2csIFwiXCIpXHRcclxuXHJcblx0XHRcdFx0XHRcdFx0Y29udGVudFN0cmluZyArPSBcIj4gbGlua2VkIGZyb206IFtbI15cIiArIGVkZ2UuZnJvbU5vZGUgKyBcInxcIiArIGZvdW5kNSArIFwiXV1cXG5cIlxyXG5cdFx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gRW1iZWRkaW5nXHJcblx0XHRcdFx0XHRjb250ZW50U3RyaW5nICs9IFwiXFxuICFbW1wiICsgIGVsZW1lbnRbMl0gKyBcIl1dXFxuXFxuXCJcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCBjYW52YXNub2RlRmlsZVxyXG5cclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQgY25mYWJzdCA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjbmZuYW1lKTtcclxuXHRcdFx0XHR0aGlzLmFwcC52YXVsdC5kZWxldGUoY25mYWJzdCwgdHJ1ZSlcclxuXHRcdFx0XHRjYW52YXNub2RlRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShjbmZuYW1lLCBlbGVtZW50WzRdKVxyXG5cdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZSlcclxuXHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0fVx0XHJcblxyXG5cdFx0fVxyXG5cclxuICAgXHQgICAgdHJ5IHtcclxuXHQgICAgICBjYW52YXNGaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGNhbnZhc0ZpbGVuYW1lLCBjb250ZW50U3RyaW5nKVxyXG5cdCAgICB9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiZXJyb3Igd3JpdGluZyB0aGUgbmV3IGRvYyBmaWxlIFwiICsgZSlcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBjbmZhYnN0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGNhbnZhc0ZpbGVuYW1lKTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZignc3BsaXQnKS5vcGVuRmlsZShjbmZhYnN0KTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0Y29uc29sZS5sb2coZSlcclxuXHRcdH1cclxuXHRcdHJldHVybiB0cnVlXHJcblxyXG5cdH1cclxufVxyXG5cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBNkg7QUFFN0gsV0FBc0I7QUFHdEIsSUFBcUIsd0JBQXJCLGNBQW1ELHVCQUFPO0FBQUEs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RUQsT0FBTztBQUdOLDJCQUFpQixTQUFTLFVBQVUsZ0JBQWdCLFFBQVEsQ0FBQyxJQUFJO0FBQ2pFLDJCQUFpQixRQUFRLENBQUMsSUFBSSxPQUFPLFFBQVEsQ0FBQyxJQUFJO0FBQ2xELDJCQUFpQjtBQUVqQixxQkFBVyxRQUFRLGNBQWMsT0FBTztBQUV2QyxnQkFBSSxLQUFLLFlBQVksUUFBUSxDQUFDLEdBQUc7QUFDaEMsb0JBQU0sUUFBUSxRQUFRLEtBQUssQ0FBQ0EsYUFBWUEsU0FBUSxDQUFDLEtBQUssS0FBSyxNQUFNO0FBQ2pFLG9CQUFNLFlBQVksTUFBTSxDQUFDLEVBQUUsTUFBTSxJQUFJLEVBQUUsQ0FBQztBQUN4QyxvQkFBTSxTQUFTLFVBQVUsUUFBUSxNQUFNLEVBQUU7QUFFekMsK0JBQWlCLHVCQUF1QixLQUFLLFNBQVMsTUFBTSxTQUFTO0FBQUEsWUFDdEU7QUFDQSxnQkFBSSxLQUFLLFVBQVUsUUFBUSxDQUFDLEdBQUc7QUFDOUIsb0JBQU0sUUFBUSxRQUFRLEtBQUssQ0FBQ0EsYUFBWUEsU0FBUSxDQUFDLEtBQUssS0FBSyxRQUFRO0FBQ25FLG9CQUFNLFlBQVksTUFBTSxDQUFDLEVBQUUsTUFBTSxJQUFJLEVBQUUsQ0FBQztBQUN4QyxvQkFBTSxTQUFTLFVBQVUsUUFBUSxNQUFNLEVBQUU7QUFFekMsK0JBQWlCLHdCQUF3QixLQUFLLFdBQVcsTUFBTSxTQUFTO0FBQUEsWUFDekU7QUFBQSxVQUNEO0FBR0EsMkJBQWlCLFdBQVksUUFBUSxDQUFDLElBQUk7QUFBQSxRQUMzQztBQUFBLE1BQ0Q7QUFFQSxVQUFJO0FBRUosVUFBSTtBQUNILFlBQUlDLFdBQVUsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU87QUFDMUQsYUFBSyxJQUFJLE1BQU0sT0FBT0EsVUFBUyxJQUFJO0FBQ25DLHlCQUFpQixLQUFLLElBQUksTUFBTSxPQUFPLFNBQVMsUUFBUSxDQUFDLENBQUM7QUFBQSxNQUMzRCxTQUFTLEdBQVA7QUFDRCxnQkFBUSxJQUFJLENBQUM7QUFDYjtBQUFBLE1BQ0Q7QUFBQSxJQUVEO0FBRU0sUUFBSTtBQUNMLG1CQUFhLE1BQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxnQkFBZ0IsYUFBYTtBQUFBLElBQ3hFLFNBQVMsR0FBUDtBQUNKLGNBQVEsSUFBSSxvQ0FBb0MsQ0FBQztBQUFBLElBQ2xEO0FBRUEsVUFBTSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLGNBQWM7QUFFekUsUUFBSTtBQUNILFlBQU0sS0FBSyxJQUFJLFVBQVUsUUFBUSxPQUFPLEVBQUUsU0FBUyxPQUFPO0FBQUEsSUFDM0QsU0FBUyxHQUFQO0FBQ0QsY0FBUSxJQUFJLENBQUM7QUFBQSxJQUNkO0FBQ0EsV0FBTztBQUFBLEVBRVI7QUFDRDsiLAogICJuYW1lcyI6IFsibm9kZWVudHJ5IiwgInJlc3VsdCIsICJ0cmF2ZXJzZXJlc3VsdCIsICJlbGVtZW50IiwgImNuZmFic3QiXQp9Cg==
